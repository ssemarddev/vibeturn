{"version":3,"file":"use-artist-permissions-2bfa1a86.js","sources":["../../../resources/client/web-player/backstage/use-primary-artist-for-current-user.ts","../../../resources/client/web-player/tracks/waveform/generate-waveform-data.ts","../../../common/foundation/resources/client/ui/library/forms/input-field/chip-field/chip-list.tsx","../../../resources/client/web-player/genres/genre.ts","../../../common/foundation/resources/client/ui/library/icons/material/Add.tsx","../../../common/foundation/resources/client/ui/library/interactions/dnd/drag-preview.tsx","../../../common/foundation/resources/client/ui/library/interactions/dnd/drag-state.ts","../../../common/foundation/resources/client/ui/library/interactions/interactable-event.ts","../../../common/foundation/resources/client/ui/library/interactions/active-interaction.ts","../../../common/foundation/resources/client/ui/library/interactions/utils/dom-rect-to-obj.ts","../../../common/foundation/resources/client/ui/library/interactions/dnd/update-rects.ts","../../../common/foundation/resources/client/ui/library/interactions/dnd/use-draggable.ts","../../../common/foundation/resources/client/ui/library/interactions/dnd/read-files-from-data-transfer.ts","../../../common/foundation/resources/client/ui/library/utils/array/async-iterable-to-array.ts","../../../common/foundation/resources/client/ui/library/interactions/dnd/use-droppable.ts","../../../common/foundation/resources/client/ui/library/interactions/dnd/sortable/sortable-line-strategy.ts","../../../common/foundation/resources/client/ui/library/utils/array/move-item-in-array.ts","../../../common/foundation/resources/client/ui/library/utils/array/move-item-in-new-array.ts","../../../common/foundation/resources/client/ui/library/interactions/dnd/sortable/sortable-transform-strategy.ts","../../../common/foundation/resources/client/ui/library/interactions/dnd/sortable/sortable-move-node-strategy.ts","../../../common/foundation/resources/client/ui/library/interactions/dnd/sortable/use-sortable.ts","../../../resources/client/web-player/albums/album.ts","../../../common/foundation/resources/client/ui/library/icons/material/MusicNote.tsx","../../../resources/client/web-player/tracks/track-image/track-image.tsx","../../../common/foundation/resources/client/ui/library/icons/material/Album.tsx","../../../resources/client/web-player/albums/album-image/album-image.tsx","../../../resources/client/web-player/artists/artist-link.tsx","../../../resources/client/web-player/artists/artist-links.tsx","../../../resources/client/web-player/tracks/track-link.tsx","../../../resources/client/web-player/albums/album-link.tsx","../../../common/foundation/resources/client/ui/library/icons/social/tumblr.tsx","../../../common/foundation/resources/client/ui/library/icons/material/Share.tsx","../../../common/foundation/resources/client/ui/library/utils/urls/share-link-socially.ts","../../../resources/client/web-player/sharing/share-media-buttons.tsx","../../../resources/client/web-player/tracks/play-arrow-filled.tsx","../../../common/foundation/resources/client/ui/library/icons/material/Mic.tsx","../../../resources/client/web-player/artists/artist-image/small-artist-image.tsx","../../../resources/client/web-player/albums/assign-album-to-tracks.ts","../../../resources/client/web-player/artists/requests/use-artist.ts","../../../resources/client/web-player/albums/requests/use-album.ts","../../../resources/client/web-player/tracks/requests/use-track.ts","../../../resources/client/web-player/tracks/hooks/use-track-permissions.ts","../../../resources/client/web-player/albums/use-album-permissions.ts","../../../common/foundation/resources/client/ui/library/utils/keybinds/is-ctrl-key-pressed.ts","../../../common/foundation/resources/client/ui/tables/navigate-grid.ts","../../../common/foundation/resources/client/ui/tables/table-context.ts","../../../common/foundation/resources/client/ui/tables/style/use-table-cell-style.ts","../../../common/foundation/resources/client/ui/tables/table-cell.tsx","../../../common/foundation/resources/client/ui/library/utils/keybinds/is-ctrl-or-shift-pressed.ts","../../../common/foundation/resources/client/ui/tables/style/use-table-row-style.ts","../../../common/foundation/resources/client/ui/library/interactions/use-pointer-events.ts","../../../common/foundation/resources/client/ui/tables/table-row.tsx","../../../common/foundation/resources/client/ui/tables/checkbox-column-config.tsx","../../../common/foundation/resources/client/ui/library/icons/material/ArrowDownward.tsx","../../../common/foundation/resources/client/ui/tables/header-cell.tsx","../../../common/foundation/resources/client/ui/tables/table-header-row.tsx","../../../common/foundation/resources/client/ui/tables/table.tsx","../../../common/foundation/resources/client/ui/library/utils/array/sort-array-of-objects.ts","../../../common/foundation/resources/client/ui/tables/use-sortable-table-data.ts","../../../resources/client/web-player/albums/requests/use-delete-album.ts","../../../common/foundation/resources/client/ui/library/tabs/tabs-context.tsx","../../../common/foundation/resources/client/ui/library/tabs/tab-line.tsx","../../../common/foundation/resources/client/ui/library/tabs/tab-list.tsx","../../../common/foundation/resources/client/ui/library/tabs/tab.tsx","../../../common/foundation/resources/client/ui/library/tabs/tab-panels.tsx","../../../common/foundation/resources/client/ui/library/tabs/tabs.tsx","../../../resources/client/admin/artist-datatable-page/artist-form/profile-links-form.tsx","../../../resources/client/web-player/artists/use-artist-permissions.ts"],"sourcesContent":["import {useAuth} from '@common/auth/use-auth';\nimport {UserArtist} from '@app/web-player/user-profile/user-artist';\n\nexport function usePrimaryArtistForCurrentUser(): UserArtist | undefined {\n  const {user} = useAuth();\n  return user?.artists?.find(a => a.role === 'artist');\n}\n","export const WAVE_WIDTH = 1240;\nexport const WAVE_HEIGHT = 45;\nconst BAR_WIDTH = 3;\nconst BAR_GAP: number = 0.5;\n\nexport function generateWaveformData(file: File): Promise<number[][] | null> {\n  const audioContext = new window.AudioContext();\n  return new Promise((resolve, abort) => {\n    const canvas = document.createElement('canvas');\n    const context = canvas.getContext('2d');\n\n    if (!context) {\n      abort();\n      return;\n    }\n    canvas.width = WAVE_WIDTH;\n    canvas.height = WAVE_HEIGHT;\n\n    // read file buffer\n    const reader = new FileReader();\n    reader.onload = e => {\n      const buffer = e.target?.result;\n      if (!buffer) {\n        abort();\n      } else {\n        audioContext.decodeAudioData(\n          buffer as ArrayBuffer,\n          buffer => {\n            const waveData = extractBuffer(buffer, context);\n            resolve(waveData);\n          },\n          () => resolve(null)\n        );\n      }\n    };\n    reader.readAsArrayBuffer(file);\n  });\n}\n\nfunction extractBuffer(buffer: AudioBuffer, context: CanvasRenderingContext2D) {\n  const waveData: number[][] = [];\n  const channelData = buffer.getChannelData(0);\n  const sections = WAVE_WIDTH;\n  const len = Math.floor(channelData.length / sections);\n  const maxHeight = WAVE_HEIGHT;\n  const vals = [];\n  for (let i = 0; i < sections; i += BAR_WIDTH) {\n    vals.push(bufferMeasure(i * len, len, channelData) * 10000);\n  }\n\n  for (let j = 0; j < sections; j += BAR_WIDTH) {\n    const scale = maxHeight / Math.max(...vals);\n    let val = bufferMeasure(j * len, len, channelData) * 10000;\n    val *= scale;\n    val += 1;\n    waveData.push(getBarData(j, val));\n  }\n\n  // clear canvas for redrawing\n  context.clearRect(0, 0, WAVE_WIDTH, WAVE_HEIGHT);\n  return waveData;\n}\n\nfunction bufferMeasure(position: number, length: number, data: Float32Array) {\n  let sum = 0.0;\n  for (let i = position; i <= position + length - 1; i++) {\n    sum += Math.pow(data[i], 2);\n  }\n  return Math.sqrt(sum / data.length);\n}\n\nfunction getBarData(i: number, h: number) {\n  let w = BAR_WIDTH;\n  if (BAR_GAP !== 0) {\n    w *= Math.abs(1 - BAR_GAP);\n  }\n  const x = i + w / 2,\n    y = WAVE_HEIGHT - h;\n\n  return [x, y, w, h];\n}\n","import React, {\n  Children,\n  cloneElement,\n  isValidElement,\n  ReactElement,\n  ReactNode,\n} from 'react';\nimport clsx from 'clsx';\nimport type {ChipProps} from './chip';\n\nexport interface ChipListProps {\n  className?: string;\n  children?: ReactElement | ReactElement[];\n  size?: ChipProps['size'];\n  radius?: ChipProps['radius'];\n  color?: ChipProps['color'];\n  selectable?: ChipProps['selectable'];\n  wrap?: boolean;\n  startButton?: ReactNode;\n}\nexport function ChipList({\n  className,\n  children,\n  size,\n  color,\n  radius,\n  selectable,\n  wrap = true,\n  startButton,\n}: ChipListProps) {\n  return (\n    <div\n      className={clsx(\n        'flex items-center gap-8',\n        wrap && 'flex-wrap',\n        className,\n      )}\n    >\n      {startButton}\n      {Children.map(children, chip => {\n        if (isValidElement<ChipProps>(chip)) {\n          return cloneElement<ChipProps>(chip, {\n            size,\n            color,\n            selectable,\n            radius,\n          });\n        }\n      })}\n    </div>\n  );\n}\n","export const GENRE_MODEL = 'genre';\n\nexport interface Genre {\n  id: number;\n  name: string;\n  display_name: string;\n  model_type: 'genre';\n  image: string;\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const AddIcon = createSvgIcon(\n  <path d=\"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z\" />\n, 'AddOutlined');\n","import {createPortal, flushSync} from 'react-dom';\nimport React, {useImperativeHandle, useRef, useState} from 'react';\nimport {ConnectedDraggable, DragPreviewRenderer} from './use-draggable';\nimport {rootEl} from '@ui/root-el';\n\nexport interface DragPreviewProps {\n  children: (draggable: ConnectedDraggable) => JSX.Element;\n}\nexport const DragPreview = React.forwardRef<\n  DragPreviewRenderer,\n  DragPreviewProps\n>((props, ref) => {\n  const render = props.children;\n  const [children, setChildren] = useState<JSX.Element | null>(null);\n  const domRef = useRef<HTMLDivElement>(null!);\n\n  useImperativeHandle(\n    ref,\n    () =>\n      (\n        draggable: ConnectedDraggable,\n        callback: (node: HTMLElement) => void,\n      ) => {\n        // This will be called during the onDragStart event by useDrag. We need to render the\n        // preview synchronously before this event returns, so we can call event.dataTransfer.setDragImage.\n        flushSync(() => {\n          setChildren(render(draggable));\n        });\n\n        // Yield back to useDrag to set the drag image.\n        callback(domRef.current);\n\n        // Remove the preview from the DOM after a frame so the browser has time to paint.\n        requestAnimationFrame(() => {\n          setChildren(null);\n        });\n      },\n    [render],\n  );\n\n  if (!children) {\n    return null;\n  }\n\n  // portal preview, in case in needs to be used in <tr> or another element that does not accept div as child\n  return createPortal(\n    <div\n      style={{zIndex: -100, position: 'absolute', top: 0, left: -100000}}\n      ref={domRef}\n    >\n      {children}\n    </div>,\n    rootEl,\n  );\n});\n","import {DragMonitor} from './use-drag-monitor';\nimport {ConnectedDraggable, DraggableId} from './use-draggable';\nimport {ConnectedDroppable} from './use-droppable';\n\nexport type DragSessionStatus =\n  | 'dropSuccess'\n  | 'dropFail'\n  | 'dragging'\n  | 'inactive';\n\nexport interface DragSession {\n  dragTargetId?: DraggableId;\n  status: DragSessionStatus;\n}\n\nexport const draggables = new Map<DraggableId, ConnectedDraggable>();\nexport const droppables = new Map<DraggableId, ConnectedDroppable>();\nexport const dragMonitors = new Map<DraggableId, DragMonitor>();\nexport const dragSession: DragSession = {\n  status: 'inactive',\n};\n","import React from 'react';\n\ntype NativeEvent =\n  | React.PointerEvent\n  | PointerEvent\n  | React.DragEvent<HTMLElement>\n  | DragEvent;\n\nexport interface InteractableEvent {\n  x: number;\n  y: number;\n  deltaX: number;\n  deltaY: number;\n  rect: InteractableRect;\n  nativeEvent: NativeEvent;\n}\n\nexport interface InteractableRect {\n  left: number;\n  top: number;\n  width: number;\n  height: number;\n  angle?: number;\n}\n\nexport function interactableEvent({\n  e,\n  rect,\n  deltaX,\n  deltaY,\n}: {\n  e: NativeEvent;\n  rect: InteractableRect;\n  deltaX?: number;\n  deltaY?: number;\n}): InteractableEvent {\n  return {\n    rect,\n    x: e.clientX,\n    y: e.clientY,\n    deltaX: deltaX ?? 0,\n    deltaY: deltaY ?? 0,\n    nativeEvent: e,\n  };\n}\n","type InteractionName = null | 'resize' | 'rotate' | 'drag' | 'move';\n\nexport let activeInteraction: InteractionName = null;\n\nexport function setActiveInteraction(name: InteractionName) {\n  activeInteraction = name;\n}\n","import {InteractableRect} from '../interactable-event';\n\nexport function domRectToObj(rect: DOMRect): InteractableRect {\n  return {\n    left: rect.left,\n    top: rect.top,\n    width: rect.width,\n    height: rect.height,\n  };\n}\n","// use intersection observer instead of getBoundingClientRect for better performance as this will be called in onPointerMove event\nimport {InteractableRect} from '../interactable-event';\nimport {ConnectedMouseSelectable} from './mouse-selection/use-mouse-selectable';\nimport {DraggableId} from './use-draggable';\nimport {ConnectedDroppable} from './use-droppable';\n\nexport function updateRects(\n  targets: Map<DraggableId, ConnectedDroppable | ConnectedMouseSelectable>\n) {\n  const observer = new IntersectionObserver(entries => {\n    entries.forEach(entry => {\n      const {width, height, left, top} = entry.boundingClientRect;\n      const [id, target] =\n        [...targets].find(\n          ([, target]) => target.ref.current === entry.target\n        ) || [];\n      if (id == null || target == null) return;\n\n      const rect: InteractableRect = {\n        width,\n        height,\n        left,\n        top,\n      };\n      targets.set(id, {...target, rect});\n    });\n    observer.disconnect();\n  });\n\n  [...targets.values()].forEach(target => {\n    if (target.ref.current) {\n      observer.observe(target.ref.current);\n    }\n  });\n}\n","import React, {RefObject, useLayoutEffect, useRef} from 'react';\nimport {draggables, dragMonitors, dragSession, droppables} from './drag-state';\nimport {\n  InteractableEvent,\n  interactableEvent,\n  InteractableRect,\n} from '../interactable-event';\nimport {activeInteraction, setActiveInteraction} from '../active-interaction';\nimport {domRectToObj} from '../utils/dom-rect-to-obj';\nimport {updateRects} from './update-rects';\nimport {useGlobalListeners} from '@react-aria/utils';\nimport {DragMonitor} from './use-drag-monitor';\nimport {NativeFileDraggable} from './use-droppable';\n\ninterface DragState {\n  currentRect?: InteractableRect;\n  lastPosition: {x: number; y: number};\n  clickedEl?: HTMLElement;\n}\n\nexport type DragPreviewRenderer = (\n  draggable: ConnectedDraggable,\n  callback: (node: HTMLElement) => void\n) => void;\n\nexport type DraggableId = string | number | object;\n\nexport interface ConnectedDraggable<T = any> {\n  type: string;\n  id: DraggableId;\n  getData: () => T;\n  ref: RefObject<HTMLElement>;\n}\n\n// Either draggable from within the app, or file dragged in from the desktop\nexport type MixedDraggable = ConnectedDraggable | NativeFileDraggable;\n\ninterface UseDragProps extends ConnectedDraggable {\n  disabled?: boolean;\n  onDragStart?: (e: InteractableEvent, target: ConnectedDraggable) => void;\n  onDragMove?: (e: InteractableEvent, target: ConnectedDraggable) => void;\n  onDragEnd?: (e: InteractableEvent, target: ConnectedDraggable) => void;\n  preview?: RefObject<DragPreviewRenderer>;\n  hidePreview?: boolean;\n}\nexport function useDraggable({\n  id,\n  disabled,\n  ref,\n  preview,\n  hidePreview,\n  ...options\n}: UseDragProps) {\n  const dragHandleRef = useRef<HTMLButtonElement>(null);\n  const {addGlobalListener, removeAllGlobalListeners} = useGlobalListeners();\n\n  const state = useRef<DragState>({\n    lastPosition: {x: 0, y: 0},\n  }).current;\n\n  const optionsRef = useRef(options);\n  optionsRef.current = options;\n\n  useLayoutEffect(() => {\n    if (!disabled) {\n      draggables.set(id, {\n        ...draggables.get(id),\n        id,\n        ref,\n        type: optionsRef.current.type,\n        getData: optionsRef.current.getData,\n      });\n    } else {\n      draggables.delete(id);\n    }\n    return () => {\n      draggables.delete(id);\n    };\n  }, [id, disabled, optionsRef, ref]);\n\n  // notify monitors connected to the same drag type as this draggable\n  const notifyMonitors = (callback: (m: DragMonitor) => void) => {\n    dragMonitors.forEach(monitor => {\n      if (monitor.type === draggables.get(id)?.type) {\n        callback(monitor);\n      }\n    });\n  };\n\n  const onDragStart = (e: React.DragEvent<HTMLElement>) => {\n    const draggable = draggables.get(id);\n    const el = ref.current;\n    const clickedOnHandle =\n      !dragHandleRef.current ||\n      !state.clickedEl ||\n      dragHandleRef.current.contains(state.clickedEl);\n\n    // if another interaction is in progress (rotate, resize, drag etc.), bail\n    if (activeInteraction || !el || !draggable || !clickedOnHandle) {\n      e.preventDefault();\n      e.stopPropagation();\n      return;\n    }\n\n    updateRects(droppables);\n    setActiveInteraction('drag');\n\n    // hide default browser ghost image\n    if (hidePreview) {\n      hideNativeGhostImage(e);\n    }\n    // this will hide default browser cursor icon, if \"dropEffect\" is not set in dragOver/dragEnter\n    e.dataTransfer.effectAllowed = 'move';\n\n    state.lastPosition = {x: e.clientX, y: e.clientY};\n    state.currentRect = domRectToObj(el.getBoundingClientRect());\n    const ie = interactableEvent({rect: state.currentRect!, e});\n\n    // If there is a preview option, use it to render a custom preview image that will\n    // appear under the pointer while dragging. If not, the element itself is dragged by the browser.\n    if (preview?.current) {\n      preview.current(draggable, node => {\n        e.dataTransfer.setDragImage(node, 0, 0);\n      });\n    }\n\n    dragSession.status = 'dragging';\n    dragSession.dragTargetId = id;\n    if (ref.current) {\n      ref.current.dataset.dragging = 'true';\n    }\n\n    optionsRef.current.onDragStart?.(ie, draggable);\n\n    // wait until next frame so changes made in \"onDragStart\" are reflected in drag monitors\n    requestAnimationFrame(() => {\n      notifyMonitors(m => m.onDragStart?.(ie, draggable));\n    });\n\n    // firefox does not provide clientX/clientY in \"onDrag\", need to listen for dragOver on window instead\n    addGlobalListener(window, 'dragover', onDragOver, true);\n  };\n\n  const onDragOver = (e: React.DragEvent<HTMLElement> | DragEvent) => {\n    e.preventDefault();\n\n    if (!state.currentRect) return;\n\n    const deltaX = e.clientX - state.lastPosition.x;\n    const deltaY = e.clientY - state.lastPosition.y;\n\n    const newRect = {\n      ...state.currentRect,\n      left: state.currentRect.left + deltaX,\n      top: state.currentRect.top + deltaY,\n    };\n\n    const ie = interactableEvent({rect: newRect, e, deltaX, deltaY});\n\n    const target = draggables.get(id);\n    if (target) {\n      optionsRef.current.onDragMove?.(ie, target);\n      notifyMonitors(m => m.onDragMove?.(ie, target));\n    }\n\n    state.lastPosition = {x: e.clientX, y: e.clientY};\n    state.currentRect = newRect;\n  };\n\n  const onDragEnd = (e: React.DragEvent<HTMLElement>) => {\n    removeAllGlobalListeners();\n    if (!state.currentRect) return;\n\n    setActiveInteraction(null);\n    if (emptyImage) {\n      emptyImage.remove();\n    }\n\n    const ie = interactableEvent({rect: state.currentRect, e});\n\n    const draggable = draggables.get(id);\n    if (draggable) {\n      optionsRef.current.onDragEnd?.(ie, draggable);\n      notifyMonitors(m => m.onDragEnd?.(ie, draggable, dragSession!.status));\n    }\n\n    // wait a frame before clearing so monitors have a chance to use drag session status\n    requestAnimationFrame(() => {\n      dragSession.dragTargetId = undefined;\n      dragSession.status = 'inactive';\n      if (ref.current) {\n        delete ref.current.dataset.dragging;\n      }\n    });\n  };\n\n  const draggableProps = {\n    draggable: !disabled,\n    onDragStart,\n    onDragEnd,\n    onPointerDown: (e: React.PointerEvent) => {\n      state.clickedEl = e.target as HTMLElement;\n    },\n  };\n\n  return {draggableProps, dragHandleRef};\n}\n\nlet emptyImage: HTMLImageElement | undefined;\nfunction hideNativeGhostImage(e: React.DragEvent) {\n  if (!emptyImage) {\n    emptyImage = new Image();\n    // image needs to be in the dom to prevent \"globe\" icon in chrome\n    document.body.append(emptyImage);\n    emptyImage.src =\n      'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\n  }\n\n  e.dataTransfer.setDragImage(emptyImage, 0, 0);\n}\n","import {UploadedFile} from '@ui/utils/files/uploaded-file';\n\nexport async function* readFilesFromDataTransfer(dataTransfer: DataTransfer) {\n  const entries: FileSystemEntry[] = [];\n\n  // Pull out all entries before reading them, otherwise\n  // some entries will be lost due to recursion with promises\n  for (const item of dataTransfer.items) {\n    if (item.kind === 'file') {\n      const entry = item.webkitGetAsEntry();\n      if (entry) {\n        entries.push(entry);\n      }\n    }\n  }\n\n  for (const entry of entries) {\n    if (entry.isFile) {\n      if (entry.name === '.DS_Store') continue;\n      const file = await getEntryFile(entry as FileSystemFileEntry);\n      yield new UploadedFile(file, entry.fullPath);\n    } else if (entry.isDirectory) {\n      yield* getEntriesFromDirectory(entry as FileSystemDirectoryEntry);\n    }\n  }\n}\n\nasync function* getEntriesFromDirectory(\n  item: FileSystemDirectoryEntry,\n): AsyncIterable<any> {\n  const reader = item.createReader();\n\n  // We must call readEntries repeatedly because there may be a limit to the\n  // number of entries that are returned at once.\n  let entries: FileSystemEntry[];\n  do {\n    entries = await new Promise((resolve, reject) => {\n      reader.readEntries(resolve, reject);\n    });\n\n    for (const entry of entries) {\n      if (entry.isFile) {\n        if (entry.name === '.DS_Store') continue;\n        const file = await getEntryFile(entry as FileSystemFileEntry);\n        yield new UploadedFile(file, entry.fullPath);\n      } else if (entry.isDirectory) {\n        yield* getEntriesFromDirectory(entry as FileSystemDirectoryEntry);\n      }\n    }\n  } while (entries.length > 0);\n}\n\nfunction getEntryFile(entry: FileSystemFileEntry): Promise<File> {\n  return new Promise((resolve, reject) => entry.file(resolve, reject));\n}\n","export async function asyncIterableToArray<T>(\n  iterator: AsyncIterable<T>\n): Promise<T[]> {\n  const items: T[] = [];\n  for await (const item of iterator) {\n    items.push(item);\n  }\n  return items;\n}\n","import React, {RefObject, useLayoutEffect, useRef} from 'react';\nimport {draggables, dragSession, droppables} from './drag-state';\nimport {readFilesFromDataTransfer} from './read-files-from-data-transfer';\nimport {asyncIterableToArray} from '@ui/utils/array/async-iterable-to-array';\nimport {InteractableRect} from '../interactable-event';\nimport {DraggableId, MixedDraggable} from './use-draggable';\nimport {UploadedFile} from '@ui/utils/files/uploaded-file';\n\nexport interface ConnectedDroppable {\n  id: DraggableId;\n  rect?: InteractableRect;\n  disabled?: boolean;\n  ref: RefObject<HTMLElement>;\n}\n\n// File dragged in from desktop\nexport interface NativeFileDraggable {\n  type: 'nativeFile';\n  el: null;\n  ref: null;\n  getData: () => Promise<UploadedFile[]>;\n}\n\ninterface UseDroppableProps<T extends HTMLElement> {\n  id: DraggableId;\n  disabled?: boolean;\n  types: ('nativeFile' | string)[];\n  ref: RefObject<T>;\n  // this will fire dragEnter/dragLeave/dragOver events when same element is both draggable and drop target and dragging target over itself. Used for showing line previews before/after element during sort.\n  allowDragEventsFromItself?: boolean;\n  onDragEnter?: (target: MixedDraggable) => void;\n  onDragLeave?: (target: MixedDraggable) => void;\n  onDragOver?: (\n    target: MixedDraggable,\n    e: React.DragEvent<HTMLElement>,\n  ) => void;\n  // Handler that is called after draggable is held over droppable for a period of time.\n  // This typically opens the item so that the user can drop within it.\n  onDropActivate?: (e: MixedDraggable) => void;\n  onDrop?: (target: MixedDraggable) => void | Promise<void> | false;\n  acceptsDrop?: (target: MixedDraggable) => boolean;\n}\n\ninterface DroppableState {\n  dragOverElements: Set<Element>;\n  dropActivateTimer: ReturnType<typeof setTimeout> | undefined;\n}\n\nconst DROP_ACTIVATE_TIMEOUT = 400;\n\nexport function useDroppable<T extends HTMLElement>({\n  id,\n  disabled,\n  ref,\n  ...options\n}: UseDroppableProps<T>) {\n  const state = useRef<DroppableState>({\n    dragOverElements: new Set<Element>(),\n    dropActivateTimer: undefined,\n  }).current;\n\n  const optionsRef = useRef(options);\n  optionsRef.current = options;\n\n  useLayoutEffect(() => {\n    droppables.set(id, {\n      ...droppables.get(id),\n      disabled,\n      id,\n      ref,\n    });\n    return () => {\n      droppables.delete(id);\n    };\n  }, [id, optionsRef, disabled, ref]);\n\n  // check if drop target accepts drag target\n  const canDrop = (draggable: MixedDraggable): boolean => {\n    const options = optionsRef.current;\n\n    const allowEventsOnSelf =\n      options.allowDragEventsFromItself ||\n      ref.current !== draggable.ref?.current;\n\n    return !!(\n      draggable?.type &&\n      allowEventsOnSelf &&\n      options.types.includes(draggable.type) &&\n      (!options.acceptsDrop || options.acceptsDrop(draggable))\n    );\n  };\n\n  const fireDragLeave = (e: React.DragEvent<HTMLElement>) => {\n    const draggable = getDraggable(e);\n    if (draggable) {\n      optionsRef.current.onDragLeave?.(draggable);\n    }\n  };\n\n  const onDragEnter = (e: React.DragEvent<HTMLElement>) => {\n    e.stopPropagation();\n\n    state.dragOverElements.add(e.target as Element);\n    if (state.dragOverElements.size > 1) {\n      return;\n    }\n\n    const draggable = getDraggable(e);\n    if (draggable && canDrop(draggable)) {\n      optionsRef.current.onDragEnter?.(draggable);\n\n      clearTimeout(state.dropActivateTimer);\n      if (typeof optionsRef.current.onDropActivate === 'function') {\n        state.dropActivateTimer = setTimeout(() => {\n          if (draggable) {\n            optionsRef.current.onDropActivate?.(draggable);\n          }\n        }, DROP_ACTIVATE_TIMEOUT);\n      }\n    }\n  };\n\n  const onDragLeave = (e: React.DragEvent<HTMLElement>) => {\n    e.stopPropagation();\n\n    // Track all the targets of dragenter events in a set, and remove them\n    // in dragleave. When the set becomes empty, we've left the drop target completely.\n    // We must also remove any elements that are no longer in the DOM, because dragleave\n    // events will never be fired for these. This can happen, for example, with drop\n    // indicators between items, which disappear when the drop target changes.\n    state.dragOverElements.delete(e.target as Element);\n    for (const element of state.dragOverElements) {\n      if (!e.currentTarget.contains(element)) {\n        state.dragOverElements.delete(element);\n      }\n    }\n\n    if (state.dragOverElements.size > 0) {\n      return;\n    }\n\n    const draggable = getDraggable(e);\n    if (draggable && canDrop(draggable)) {\n      fireDragLeave(e);\n      clearTimeout(state.dropActivateTimer);\n    }\n  };\n\n  const onDrop = async (e: React.DragEvent<HTMLElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n    state.dragOverElements.clear();\n\n    fireDragLeave(e);\n    clearTimeout(state.dropActivateTimer);\n\n    const draggable = getDraggable(e);\n    if (draggable) {\n      optionsRef.current.onDragLeave?.(draggable);\n\n      // drop target does not accept this type of droppable\n      if (!canDrop(draggable)) {\n        if (dragSession.status !== 'inactive') {\n          dragSession.status = 'dropFail';\n        }\n        // drop target accepts this type, but it might still reject the drop in callback\n      } else {\n        // allow callback to mark drop as failed\n        const dropResult = optionsRef.current.onDrop?.(draggable);\n\n        // drag session will only be active for draggables within the app, never for files dragged in from desktop\n        if (dragSession.status !== 'inactive') {\n          dragSession.status =\n            dropResult === false ? 'dropFail' : 'dropSuccess';\n        }\n      }\n    }\n  };\n\n  const droppableProps = {\n    onDragOver: (e: React.DragEvent<HTMLElement>) => {\n      e.preventDefault();\n      e.stopPropagation();\n      const draggable = getDraggable(e);\n      if (draggable && canDrop(draggable)) {\n        optionsRef.current.onDragOver?.(draggable, e);\n      }\n    },\n    onDragEnter,\n    onDragLeave,\n    onDrop,\n  };\n\n  return {\n    droppableProps: disabled ? {} : droppableProps,\n  };\n}\n\nfunction getDraggable(\n  e: React.DragEvent<HTMLElement>,\n): MixedDraggable | undefined {\n  if (dragSession.dragTargetId != null) {\n    return draggables.get(dragSession.dragTargetId);\n  } else if (e.dataTransfer.types.includes('Files')) {\n    return {\n      type: 'nativeFile',\n      el: null,\n      ref: null,\n      getData: () => {\n        return asyncIterableToArray(readFilesFromDataTransfer(e.dataTransfer));\n      },\n    };\n  }\n}\n","import {\n  DropPosition,\n  SortSession,\n} from '@ui/interactions/dnd/sortable/use-sortable';\nimport {SortableStrategy} from '@ui/interactions/dnd/sortable/sortable-strategy';\nimport {droppables} from '@ui/interactions/dnd/drag-state';\n\nexport const sortableLineStrategy: SortableStrategy = {\n  onDragStart: () => {},\n  onDragEnter: () => {},\n  onDragOver: ({e, ref, item, sortSession, onDropPositionChange}) => {\n    const previousPosition = sortSession.dropPosition;\n    let newPosition: DropPosition = null;\n\n    const rect = droppables.get(item)?.rect;\n    if (rect) {\n      const midY = rect.top + rect.height / 2;\n      if (e.clientY <= midY) {\n        newPosition = 'before';\n      } else if (e.clientY >= midY) {\n        newPosition = 'after';\n      }\n    }\n\n    if (newPosition !== previousPosition) {\n      const overIndex = sortSession.sortables.indexOf(item);\n      sortSession.dropPosition = newPosition;\n      onDropPositionChange?.(sortSession.dropPosition);\n\n      clearLinePreview(sortSession);\n      if (ref.current) {\n        if (sortSession.dropPosition === 'after') {\n          addLinePreview(ref.current, 'bottom', sortSession);\n        } else {\n          // if it's the first row, add preview to the top border, as there's no previous element\n          if (overIndex === 0) {\n            addLinePreview(ref.current, 'top', sortSession);\n            // otherwise add preview to the bottom border of the previous row\n          } else {\n            const droppableId = sortSession.sortables[overIndex - 1];\n            const droppable = droppables.get(droppableId);\n            if (droppable?.ref.current) {\n              addLinePreview(droppable.ref.current, 'bottom', sortSession);\n            }\n          }\n        }\n      }\n\n      const itemIndex = sortSession.sortables.indexOf(item);\n\n      // don't move item at all if hovering over itself\n      if (sortSession.activeIndex === itemIndex) {\n        sortSession.finalIndex = sortSession.activeIndex;\n        return;\n      }\n\n      // adjust final drop index based on whether we're dropping drag target after or before it's original index\n      // this is needed, so we get the same index if target is dropped after current item or before next item\n      const dragDirection =\n        overIndex > sortSession.activeIndex ? 'after' : 'before';\n      if (dragDirection === 'after') {\n        sortSession.finalIndex =\n          sortSession.dropPosition === 'before' ? itemIndex - 1 : itemIndex;\n      } else {\n        sortSession.finalIndex =\n          sortSession.dropPosition === 'after' ? itemIndex + 1 : itemIndex;\n      }\n    }\n  },\n  onDragEnd: sortSession => {\n    clearLinePreview(sortSession);\n  },\n};\n\nfunction clearLinePreview(sortSession: SortSession) {\n  if (sortSession?.linePreviewEl) {\n    sortSession.linePreviewEl.style.borderBottomColor = '';\n    sortSession.linePreviewEl.style.borderTopColor = '';\n    sortSession.linePreviewEl = undefined;\n  }\n}\n\nfunction addLinePreview(\n  el: HTMLElement,\n  side: 'top' | 'bottom',\n  sortSession: SortSession,\n) {\n  const color = 'rgb(var(--be-primary))';\n  if (side === 'top') {\n    el.style.borderTopColor = color;\n  } else {\n    el.style.borderBottomColor = color;\n  }\n  if (sortSession) {\n    sortSession.linePreviewEl = el;\n  }\n}\n","import {clamp} from '@ui/utils/number/clamp';\n\nexport function moveItemInArray<T = any>(\n  array: T[],\n  fromIndex: number,\n  toIndex: number,\n): T[] {\n  const from = clamp(fromIndex, 0, array.length - 1);\n  const to = clamp(toIndex, 0, array.length - 1);\n\n  if (from === to) {\n    return array;\n  }\n\n  const target = array[from];\n  const delta = to < from ? -1 : 1;\n\n  for (let i = from; i !== to; i += delta) {\n    array[i] = array[i + delta];\n  }\n\n  array[to] = target;\n\n  return array;\n}\n","export function moveItemInNewArray<T>(\n  array: T[],\n  from: number,\n  to: number\n): T[] {\n  const newArray = array.slice();\n  newArray.splice(\n    to < 0 ? newArray.length + to : to,\n    0,\n    newArray.splice(from, 1)[0]\n  );\n\n  return newArray;\n}\n","import {moveItemInArray} from '@ui/utils/array/move-item-in-array';\nimport {droppables} from '@ui/interactions/dnd/drag-state';\nimport {moveItemInNewArray} from '@ui/utils/array/move-item-in-new-array';\nimport type {SortSession} from '@ui/interactions/dnd/sortable/use-sortable';\nimport type {SortableStrategy} from '@ui/interactions/dnd/sortable/sortable-strategy';\n\nconst transition = 'transform 0.2s cubic-bezier(0.2, 0, 0, 1)';\n\nexport const sortableTransformStrategy: SortableStrategy = {\n  onDragStart: sortSession => {\n    sortSession.sortables.forEach((sortable, index) => {\n      const droppable = droppables.get(sortable);\n      if (!droppable?.ref.current) return;\n\n      droppable.ref.current.style.transition = transition;\n\n      if (sortSession?.activeIndex === index) {\n        droppable.ref.current.style.opacity = '0.4';\n      }\n    });\n  },\n  onDragEnter: (\n    sortSession: SortSession,\n    overIndex: number,\n    currentIndex: number,\n  ) => {\n    moveItemInArray(sortSession.sortables, currentIndex, overIndex);\n    const rects = sortSession.sortables.map(s => droppables.get(s)?.rect);\n\n    sortSession.sortables.forEach((sortable, index) => {\n      if (!sortSession) return;\n\n      const newRects = moveItemInNewArray(\n        rects,\n        overIndex,\n        sortSession.activeIndex,\n      );\n      const oldRect = rects[index];\n      const newRect = newRects[index];\n      const sortableTarget = droppables.get(sortable);\n\n      if (sortableTarget?.ref.current && newRect && oldRect) {\n        const x = newRect.left - oldRect.left;\n        const y = newRect.top - oldRect.top;\n        sortableTarget.ref.current.style.transform = `translate3d(${x}px, ${y}px, 0)`;\n      }\n    });\n\n    sortSession.finalIndex = overIndex;\n  },\n  onDragOver: () => {},\n  onDragEnd: sortSession => {\n    // clear any styles and transforms applied to sortables during sorting\n    sortSession.sortables.forEach(sortable => {\n      const droppable = droppables.get(sortable);\n      if (droppable?.ref.current) {\n        droppable.ref.current.style.transform = '';\n        droppable.ref.current.style.transition = '';\n        droppable.ref.current.style.opacity = '';\n        droppable.ref.current.style.zIndex = '';\n      }\n    });\n  },\n};\n","import {moveItemInArray} from '@ui/utils/array/move-item-in-array';\nimport {droppables} from '@ui/interactions/dnd/drag-state';\nimport {SortableStrategy} from '@ui/interactions/dnd/sortable/sortable-strategy';\n\nexport const sortableMoveNodeStrategy: SortableStrategy = {\n  onDragStart: () => {},\n  onDragOver: () => {},\n  onDragEnter: (sortSession, overIndex: number, currentIndex: number) => {\n    const node = droppables.get(sortSession.sortables[currentIndex])?.ref\n      .current;\n    if (node) {\n      moveNode(node, currentIndex, overIndex);\n      moveItemInArray(sortSession.sortables, currentIndex, overIndex);\n      sortSession.finalIndex = overIndex;\n    }\n  },\n  onDragEnd: () => {},\n};\n\nfunction moveNode(el: HTMLElement, currentIndex: number, newIndex: number) {\n  const parentEl = el.parentElement!;\n  if (newIndex < 0) {\n    parentEl.prepend(el);\n  } else {\n    // if parent already contains this node, and we're changing\n    // node's index within parent, need to adjust index by one\n    if (currentIndex > -1 && currentIndex <= newIndex) {\n      newIndex++;\n    }\n    const ref = parentEl.children.item(newIndex);\n    if (ref) {\n      ref.before(el);\n    } else {\n      parentEl.append(el);\n    }\n  }\n}\n","import {DraggableId, DragPreviewRenderer, useDraggable} from '../use-draggable';\nimport {useDroppable} from '../use-droppable';\nimport {RefObject, useEffect} from 'react';\nimport {getScrollParent, mergeProps} from '@react-aria/utils';\nimport {droppables} from '../drag-state';\nimport {SortableStrategy} from '@ui/interactions/dnd/sortable/sortable-strategy';\nimport {sortableLineStrategy} from '@ui/interactions/dnd/sortable/sortable-line-strategy';\nimport {sortableTransformStrategy} from '@ui/interactions/dnd/sortable/sortable-transform-strategy';\nimport {sortableMoveNodeStrategy} from '@ui/interactions/dnd/sortable/sortable-move-node-strategy';\nimport {updateRects} from '@ui/interactions/dnd/update-rects';\n\nexport interface SortSession {\n  // items in this list will be moved when user is sorting\n  sortables: DraggableId[];\n\n  // sortable user started dragging to start this session\n  activeSortable: DraggableId;\n  activeIndex: number;\n\n  // final index sortable was dropped in and should be moved to\n  finalIndex: number;\n\n  // drop position for displaying line preview\n  dropPosition: DropPosition;\n  // element that currently has a line preview at the top or bottom\n  linePreviewEl?: HTMLElement;\n  scrollParent?: Element;\n  scrollListener: () => void;\n  ref: RefObject<HTMLElement>;\n}\n\nlet sortSession: null | SortSession = null;\n\nexport type DropPosition = 'before' | 'after' | null;\n\ntype StrategyName = 'line' | 'liveSort' | 'moveNode';\n\nconst strategies: Record<StrategyName, SortableStrategy> = {\n  line: sortableLineStrategy,\n  liveSort: sortableTransformStrategy,\n  moveNode: sortableMoveNodeStrategy,\n};\n\nexport interface UseSortableProps {\n  item: DraggableId;\n  items: DraggableId[];\n  onSortStart?: () => void;\n  onSortEnd?: (oldIndex: number, newIndex: number) => void;\n  onDragEnd?: () => void;\n  onDropPositionChange?: (dropPosition: DropPosition) => void;\n  ref: RefObject<HTMLElement>;\n  type: string;\n  preview?: RefObject<DragPreviewRenderer>;\n  strategy?: StrategyName;\n  disabled?: boolean;\n}\nexport function useSortable({\n  item,\n  items,\n  type,\n  ref,\n  onSortEnd,\n  onSortStart,\n  onDragEnd,\n  preview,\n  disabled,\n  onDropPositionChange,\n  strategy = 'liveSort',\n}: UseSortableProps) {\n  // todo: issue with sorting after scrolling menu editor item list\n\n  // update sortables and active index, in case we lazy load more items while sorting\n  useEffect(() => {\n    if (sortSession && sortSession.sortables.length !== items.length) {\n      sortSession.sortables = [...items];\n      sortSession.activeIndex = items.indexOf(item);\n    }\n  }, [items, item]);\n\n  const {draggableProps, dragHandleRef} = useDraggable({\n    id: item,\n    ref,\n    type,\n    preview,\n    disabled,\n    onDragStart: () => {\n      sortSession = {\n        sortables: [...items],\n        activeSortable: item,\n        activeIndex: items.indexOf(item),\n        finalIndex: items.indexOf(item),\n        dropPosition: null,\n        ref,\n        scrollParent: ref.current ? getScrollParent(ref.current) : undefined,\n        scrollListener: () => {\n          updateRects(droppables);\n        },\n      };\n      strategies[strategy].onDragStart(sortSession);\n\n      onSortStart?.();\n      sortSession.scrollParent?.addEventListener(\n        'scroll',\n        sortSession.scrollListener,\n      );\n    },\n    onDragEnd: () => {\n      if (!sortSession) return;\n\n      sortSession.dropPosition = null;\n      onDropPositionChange?.(sortSession.dropPosition);\n      if (sortSession.activeIndex !== sortSession.finalIndex) {\n        onSortEnd?.(sortSession.activeIndex, sortSession.finalIndex);\n      }\n      sortSession.scrollParent?.removeEventListener(\n        'scroll',\n        sortSession.scrollListener,\n      );\n      strategies[strategy].onDragEnd(sortSession);\n      // call \"onDragEnd\" after \"onSortEnd\", so listener has a chance to use sort session data\n      onDragEnd?.();\n      sortSession = null;\n    },\n    getData: () => {},\n  });\n\n  const {droppableProps} = useDroppable({\n    id: item,\n    ref,\n    types: [type],\n    disabled,\n    allowDragEventsFromItself: true,\n    onDragOver: (target, e) => {\n      if (!sortSession) return;\n      strategies[strategy].onDragOver({\n        e,\n        ref,\n        item,\n        sortSession,\n        onDropPositionChange,\n      });\n    },\n    onDragEnter: () => {\n      if (!sortSession) return;\n      const overIndex = sortSession.sortables.indexOf(item);\n      const oldIndex = sortSession.sortables.indexOf(\n        sortSession.activeSortable,\n      );\n      strategies[strategy].onDragEnter(sortSession, overIndex, oldIndex);\n    },\n    onDragLeave: () => {\n      if (!sortSession) return;\n      sortSession.dropPosition = null;\n      onDropPositionChange?.(sortSession.dropPosition);\n    },\n  });\n\n  return {\n    sortableProps: {...mergeProps(draggableProps, droppableProps)},\n    dragHandleRef,\n  };\n}\n","import {Genre} from '../genres/genre';\nimport {Artist} from '../artists/artist';\nimport {Tag} from '@common/tags/tag';\nimport {Track} from '@app/web-player/tracks/track';\n\nexport const ALBUM_MODEL = 'album';\n\nexport interface Album {\n  id: number;\n  name: string;\n  model_type: typeof ALBUM_MODEL;\n  release_date?: string;\n  spotify_id?: string;\n  image?: string;\n  artists?: Omit<Artist, 'albums'>[];\n  reposts_count?: number;\n  likes_count?: number;\n  plays?: number;\n  views: number;\n  description?: string;\n  tracks?: Track[];\n  tags?: Tag[];\n  genres?: Genre[];\n  created_at?: string;\n  owner_id?: number;\n  comments_count?: number;\n  tracks_count?: number;\n  updated_at: string;\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const MusicNoteIcon = createSvgIcon(\n  <path d=\"m12 3 .01 10.55c-.59-.34-1.27-.55-2-.55C7.79 13 6 14.79 6 17s1.79 4 4.01 4S14 19.21 14 17V7h4V3h-6zm-1.99 16c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z\" />\n, 'MusicNoteOutlined');\n","import {Track} from '@app/web-player/tracks/track';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {message} from '@ui/i18n/message';\nimport clsx from 'clsx';\nimport {MusicNoteIcon} from '@ui/icons/material/MusicNote';\n\ninterface TrackImageProps {\n  track: Track;\n  className?: string;\n  size?: string;\n  background?: string;\n}\nexport function TrackImage({\n  track,\n  className,\n  size,\n  background = 'bg-fg-base/4',\n}: TrackImageProps) {\n  const {trans} = useTrans();\n  const src = getTrackImageSrc(track);\n  const imgClassName = clsx(\n    className,\n    size,\n    background,\n    'object-cover',\n    !src ? 'flex items-center justify-center' : 'block',\n  );\n  return src ? (\n    <img\n      className={imgClassName}\n      draggable={false}\n      loading=\"lazy\"\n      src={src}\n      alt={trans(message('Image for :name', {values: {name: track.name}}))}\n    />\n  ) : (\n    <span className={clsx(imgClassName, 'overflow-hidden')}>\n      <MusicNoteIcon className=\"max-w-[60%] text-divider\" size=\"text-9xl\" />\n    </span>\n  );\n}\n\nexport function getTrackImageSrc(track: Track) {\n  if (track.image) {\n    return track.image;\n  } else if (track.album?.image) {\n    return track.album.image;\n  }\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const AlbumIcon = createSvgIcon(\n  <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-12.5c-2.49 0-4.5 2.01-4.5 4.5s2.01 4.5 4.5 4.5 4.5-2.01 4.5-4.5-2.01-4.5-4.5-4.5zm0 5.5c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z\" />\n, 'AlbumOutlined');\n","import {useTrans} from '@ui/i18n/use-trans';\nimport {message} from '@ui/i18n/message';\nimport {Album} from '@app/web-player/albums/album';\nimport clsx from 'clsx';\nimport {AlbumIcon} from '@ui/icons/material/Album';\n\ninterface AlbumImageProps {\n  album: Album;\n  className?: string;\n  size?: string;\n}\nexport function AlbumImage({album, className, size}: AlbumImageProps) {\n  const {trans} = useTrans();\n  const src = album?.image;\n  const imgClassName = clsx(\n    className,\n    size,\n    'object-cover bg-fg-base/4',\n    !src ? 'flex items-center justify-center' : 'block',\n  );\n\n  return src ? (\n    <img\n      className={imgClassName}\n      draggable={false}\n      loading=\"lazy\"\n      src={src}\n      alt={trans(message('Image for :name', {values: {name: album.name}}))}\n    />\n  ) : (\n    <span className={clsx(imgClassName, 'overflow-hidden')}>\n      <AlbumIcon className=\"max-w-[60%] text-divider\" size=\"text-9xl\" />\n    </span>\n  );\n}\n","import {Link, LinkProps} from 'react-router';\nimport clsx from 'clsx';\nimport React, {useMemo} from 'react';\nimport {Artist} from '@app/web-player/artists/artist';\nimport {slugifyString} from '@ui/utils/string/slugify-string';\nimport {UserArtist} from '@app/web-player/user-profile/user-artist';\nimport {getBootstrapData} from '@ui/bootstrap-data/bootstrap-data-store';\n\ninterface AlbumLinkProps extends Omit<LinkProps, 'to'> {\n  artist: Artist | UserArtist;\n  className?: string;\n}\nexport function ArtistLink({artist, className, ...linkProps}: AlbumLinkProps) {\n  const finalUri = useMemo(() => {\n    return getArtistLink(artist);\n  }, [artist]);\n\n  return (\n    <Link\n      {...linkProps}\n      className={clsx(\n        'overflow-x-hidden overflow-ellipsis outline-none hover:underline focus-visible:underline',\n        className,\n      )}\n      to={finalUri}\n    >\n      {artist.name}\n    </Link>\n  );\n}\n\nexport function getArtistLink(\n  artist: Artist | UserArtist,\n  {absolute}: {absolute?: boolean} = {},\n): string {\n  let link = `/artist/${artist.id}/${slugifyString(artist.name)}`;\n  if (absolute) {\n    link = `${getBootstrapData().settings.base_url}${link}`;\n  }\n  return link;\n}\n","import {Artist} from '@app/web-player/artists/artist';\nimport {ArtistLink} from '@app/web-player/artists/artist-link';\nimport {Fragment, HTMLAttributeAnchorTarget} from 'react';\nimport {Trans} from '@ui/i18n/trans';\nimport clsx from 'clsx';\n\ninterface ArtistLinksProps {\n  artists?: Artist[];\n  className?: string;\n  linkClassName?: string;\n  target?: HTMLAttributeAnchorTarget;\n  onLinkClick?: () => void;\n}\nexport function ArtistLinks({\n  artists,\n  className,\n  target,\n  linkClassName,\n  onLinkClick,\n}: ArtistLinksProps) {\n  if (!artists?.length) {\n    return (\n      <div className={className}>\n        <Trans message=\"Various artists\" />\n      </div>\n    );\n  }\n  return (\n    <div className={clsx(className, 'overflow-x-hidden overflow-ellipsis')}>\n      {artists.map((artist, i) => (\n        <Fragment key={artist.id}>\n          {i > 0 && ', '}\n          <ArtistLink\n            artist={artist}\n            target={target}\n            className={linkClassName}\n            onClick={onLinkClick}\n          />\n        </Fragment>\n      ))}\n    </div>\n  );\n}\n","import {Link, LinkProps} from 'react-router';\nimport clsx from 'clsx';\nimport React, {useMemo} from 'react';\nimport {slugifyString} from '@ui/utils/string/slugify-string';\nimport {Track} from '@app/web-player/tracks/track';\nimport {getBootstrapData} from '@ui/bootstrap-data/bootstrap-data-store';\n\ninterface TrackLinkProps extends Omit<LinkProps, 'to'> {\n  track: Track;\n  className?: string;\n}\nexport function TrackLink({track, className, ...linkProps}: TrackLinkProps) {\n  const finalUri = useMemo(() => {\n    return getTrackLink(track);\n  }, [track]);\n\n  return (\n    <Link\n      {...linkProps}\n      className={clsx(\n        'overflow-x-hidden overflow-ellipsis hover:underline',\n        className,\n      )}\n      to={finalUri}\n    >\n      {track.name}\n    </Link>\n  );\n}\n\nexport function getTrackLink(\n  track: Track,\n  {absolute}: {absolute?: boolean} = {},\n): string {\n  let link = `/track/${track.id}/${slugifyString(track.name)}`;\n  if (absolute) {\n    link = `${getBootstrapData().settings.base_url}${link}`;\n  }\n  return link;\n}\n","import {Link} from 'react-router';\nimport clsx from 'clsx';\nimport React, {useMemo} from 'react';\nimport {Album} from '@app/web-player/albums/album';\nimport {Artist} from '@app/web-player/artists/artist';\nimport {slugifyString} from '@ui/utils/string/slugify-string';\nimport {getBootstrapData} from '@ui/bootstrap-data/bootstrap-data-store';\n\ninterface AlbumLinkProps {\n  album: Album;\n  artist?: Artist;\n  className?: string;\n  target?: string;\n}\nexport function AlbumLink({album, artist, className, target}: AlbumLinkProps) {\n  if (!artist && album.artists) {\n    artist = album.artists[0];\n  }\n  const uri = useMemo(() => {\n    return getAlbumLink(album, {artist});\n  }, [artist, album]);\n\n  return (\n    <Link\n      target={target}\n      className={clsx(\n        'overflow-x-hidden overflow-ellipsis outline-none hover:underline focus-visible:underline',\n        className,\n      )}\n      to={uri}\n    >\n      {album.name}\n    </Link>\n  );\n}\n\nexport function getAlbumLink(\n  album: Album,\n  options: {artist?: Artist; absolute?: boolean} = {},\n) {\n  const artist = options.artist || album.artists?.[0];\n  const artistName = slugifyString(artist?.name || 'Various Artists');\n  const albumName = slugifyString(album.name);\n  let link = `/album/${album.id}/${artistName}/${albumName}`;\n  if (options.absolute) {\n    link = `${getBootstrapData().settings.base_url}${link}`;\n  }\n  return link;\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const TumblrIcon = createSvgIcon(\n  <path d=\"M390,32H120c-49.19,0-88,38.81-88,88V390c0,49.19,38.81,90,88,90H390c49.19,0,90-40.81,90-90V120C480,70.81,439.19,32,390,32ZM336,396H284c-42.51,0-72-23.68-72-76V240H176V192c42.51-11,57.95-48.32,60-80h44v72h52v56H280l-.39,70.51c0,21.87,11,29.43,28.62,29.43L336,340Z\" />\n);\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const ShareIcon = createSvgIcon(\n  <path d=\"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92c0-1.61-1.31-2.92-2.92-2.92zM18 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM6 13c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm12 7.02c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z\" />\n, 'ShareOutlined');\n","export type ShareableNetworks =\n  | 'facebook'\n  | 'twitter'\n  | 'pinterest'\n  | 'tumblr'\n  | 'blogger'\n  | 'mail';\n\nexport function shareLinkSocially(\n  network: ShareableNetworks,\n  link: string,\n  name?: string,\n  image?: string\n) {\n  const url = generateShareUrl(network, link, name, image);\n\n  if (network === 'mail') {\n    window.location.href = url;\n  } else {\n    openNewWindow(url);\n  }\n}\n\nfunction openNewWindow(url: string) {\n  const width = 575,\n    height = 400,\n    left = (window.innerWidth - width) / 2,\n    top = (window.innerHeight - height) / 2,\n    opts =\n      'status=1, scrollbars=1' +\n      ',width=' +\n      width +\n      ',height=' +\n      height +\n      ',top=' +\n      top +\n      ',left=' +\n      left;\n\n  window.open(url, 'share', opts);\n}\n\nfunction generateShareUrl(\n  type: ShareableNetworks,\n  link: string,\n  name?: string,\n  image?: string\n): string {\n  switch (type) {\n    case 'facebook':\n      return 'https://www.facebook.com/sharer/sharer.php?u=' + link;\n    case 'twitter':\n      return `https://twitter.com/intent/tweet?text=${name}&url=${link}`;\n    case 'pinterest':\n      return (\n        'https://pinterest.com/pin/create/button/?url=' +\n        link +\n        '&media=' +\n        image\n      );\n    case 'tumblr':\n      const base =\n        'https://www.tumblr.com/widgets/share/tool?shareSource=legacy&canonicalUrl=&posttype=photo&title=&caption=';\n      return base + name + '&content=' + image + '&url=' + link;\n    case 'blogger':\n      return (\n        'https://www.blogger.com/blog_this.pyra?t&u=' + link + '&n=' + name\n      );\n    case 'mail':\n      return `mailto:?subject=Check out this link.&body=${link}`;\n  }\n}\n","import {IconButton, IconButtonProps} from '@ui/buttons/icon-button';\nimport {FacebookIcon} from '@ui/icons/social/facebook';\nimport {TwitterIcon} from '@ui/icons/social/twitter';\nimport {TumblrIcon} from '@ui/icons/social/tumblr';\nimport {ShareIcon} from '@ui/icons/material/Share';\nimport {toast} from '@ui/toast/toast';\nimport {message} from '@ui/i18n/message';\nimport {\n  ShareableNetworks,\n  shareLinkSocially,\n} from '@ui/utils/urls/share-link-socially';\n\ninterface ShareButtonsProps {\n  link: string;\n  name?: string;\n  image?: string;\n  size?: IconButtonProps['size'];\n}\nexport function ShareMediaButtons({\n  link,\n  name,\n  image,\n  size = 'lg',\n}: ShareButtonsProps) {\n  const share = (network: ShareableNetworks) => {\n    shareLinkSocially(network, link, name, image);\n  };\n\n  return (\n    <div>\n      <IconButton\n        size={size}\n        onClick={() => share('facebook')}\n        className=\"text-facebook\"\n      >\n        <FacebookIcon />\n      </IconButton>\n      <IconButton\n        size={size}\n        onClick={() => share('twitter')}\n        className=\"text-twitter\"\n      >\n        <TwitterIcon />\n      </IconButton>\n      <IconButton\n        size={size}\n        onClick={() => share('tumblr')}\n        className=\"text-tumblr\"\n      >\n        <TumblrIcon viewBox=\"0 0 512 512\" />\n      </IconButton>\n      {navigator.share && (\n        <IconButton\n          size={size}\n          onClick={() => {\n            try {\n              navigator.share({\n                title: name,\n                url: link,\n              });\n            } catch (e) {\n              if ((e as DOMException).name !== 'AbortError') {\n                toast(message('Could not share link'));\n              }\n            }\n          }}\n          className=\"text-muted\"\n        >\n          <ShareIcon />\n        </IconButton>\n      )}\n    </div>\n  );\n}\n","import {createSvgIcon} from '@ui/icons/create-svg-icon';\n\nexport const PlayArrowFilledIcon = createSvgIcon(\n  <path d=\"M8 19V5l11 7Z\" />,\n  'PlayArrowFilled',\n);\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const MicIcon = createSvgIcon(\n  [<path d=\"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z\" key=\"0\" />,<path d=\"M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z\" key=\"1\" />,]\n, 'MicOutlined');\n","import {useTrans} from '@ui/i18n/use-trans';\nimport {message} from '@ui/i18n/message';\nimport {Artist} from '@app/web-player/artists/artist';\nimport {Trans} from '@ui/i18n/trans';\nimport {CheckIcon} from '@ui/icons/material/Check';\nimport clsx from 'clsx';\nimport {MicIcon} from '@ui/icons/material/Mic';\n\ninterface SmallArtistImageProps {\n  artist: Artist;\n  className?: string;\n  wrapperClassName?: string;\n  size?: string;\n  showVerifiedBadge?: boolean;\n}\nexport function SmallArtistImage({\n  artist,\n  className,\n  wrapperClassName,\n  size,\n  showVerifiedBadge = false,\n}: SmallArtistImageProps) {\n  const {trans} = useTrans();\n  const src = getSmallArtistImage(artist);\n  const imgClassName = clsx(\n    size,\n    className,\n    'bg-fg-base/4 object-cover',\n    !src ? 'flex items-center justify-center' : 'block',\n  );\n\n  const image = src ? (\n    <img\n      className={imgClassName}\n      draggable={false}\n      loading=\"lazy\"\n      src={src}\n      alt={trans(message('Image for :name', {values: {name: artist.name}}))}\n    />\n  ) : (\n    <span className={clsx(imgClassName, 'overflow-hidden')}>\n      <MicIcon className=\"max-w-[60%] text-divider\" size=\"text-9xl\" />\n    </span>\n  );\n\n  return (\n    <div\n      className={clsx('relative isolate flex-shrink-0', size, wrapperClassName)}\n    >\n      {image}\n      {showVerifiedBadge && artist.verified && (\n        <div\n          className=\"absolute bottom-24 left-0 right-0 mx-auto flex w-max max-w-full items-center gap-6 rounded-full bg-black/60 px-8 py-4 text-sm text-white\"\n          color=\"positive\"\n        >\n          <div className=\"rounded-full bg-primary p-1\">\n            <CheckIcon className=\"text-white\" size=\"sm\" />\n          </div>\n          <Trans message=\"Verified artist\" />\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport function getSmallArtistImage(artist: Artist) {\n  return artist.image_small || artist.albums?.[0]?.image;\n}\n","import {Album} from '@app/web-player/albums/album';\n\nexport function assignAlbumToTracks(album: Album): Album {\n  album.tracks = album.tracks?.map(track => {\n    if (!track.album) {\n      track.album = {...album, tracks: undefined};\n    }\n    return track;\n  });\n  return album;\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {apiClient} from '@common/http/query-client';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {useParams} from 'react-router';\nimport {Artist} from '@app/web-player/artists/artist';\nimport {PaginationResponse} from '@common/http/backend-response/pagination-response';\nimport {Album} from '@app/web-player/albums/album';\nimport {assignAlbumToTracks} from '@app/web-player/albums/assign-album-to-tracks';\nimport {Track} from '@app/web-player/tracks/track';\nimport {getBootstrapData} from '@ui/bootstrap-data/bootstrap-data-store';\n\nexport const albumLayoutKey = 'artistPage-albumLayout';\n\nexport interface UseArtistResponse extends BackendResponse {\n  artist: Artist;\n  albums?: PaginationResponse<Album>;\n  tracks?: PaginationResponse<Track>;\n  loader?: UseArtistParams['loader'];\n  selectedAlbumLayout?: string;\n}\n\nexport interface UseArtistParams {\n  loader: 'artistPage' | 'editArtistPage' | 'artist';\n}\n\nexport function useArtist(params: UseArtistParams) {\n  const {artistId} = useParams();\n  return useQuery({\n    queryKey: ['artists', artistId, params],\n    queryFn: () => fetchArtist(artistId!, params),\n    initialData: () => {\n      const data = getBootstrapData().loaders?.[params.loader];\n      if (data?.artist?.id == artistId && data?.loader === params.loader) {\n        return data;\n      }\n      return undefined;\n    },\n  });\n}\n\nfunction fetchArtist(\n  artistId: number | string,\n  params: object,\n): Promise<UseArtistResponse> {\n  return apiClient\n    .get<UseArtistResponse>(`artists/${artistId}`, {params})\n    .then(response => {\n      if (response.data.albums) {\n        response.data.albums.data = response.data.albums.data.map(album =>\n          assignAlbumToTracks(album),\n        );\n      }\n      return response.data;\n    });\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {apiClient} from '@common/http/query-client';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {useParams} from 'react-router';\nimport {Album} from '@app/web-player/albums/album';\nimport {assignAlbumToTracks} from '@app/web-player/albums/assign-album-to-tracks';\nimport {getBootstrapData} from '@ui/bootstrap-data/bootstrap-data-store';\n\nexport interface GetAlbumResponse extends BackendResponse {\n  album: Album;\n  loader: Params['loader'];\n}\n\ninterface Params {\n  loader: 'albumPage' | 'editAlbumPage' | 'album' | 'albumEmbed';\n}\n\nexport function useAlbum(params: Params) {\n  const {albumId} = useParams();\n  return useQuery({\n    queryKey: ['albums', +albumId!],\n    queryFn: () => fetchAlbum(albumId!, params),\n    initialData: () => {\n      const data = getBootstrapData().loaders?.[params.loader];\n      if (data?.album?.id == albumId && data?.loader === params.loader) {\n        return data;\n      }\n      return undefined;\n    },\n  });\n}\n\nfunction fetchAlbum(albumId: number | string, params: Params) {\n  return apiClient\n    .get<GetAlbumResponse>(`albums/${albumId}`, {\n      params,\n    })\n    .then(response => {\n      response.data.album = assignAlbumToTracks(response.data.album);\n      return response.data;\n    });\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {apiClient} from '@common/http/query-client';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {useParams} from 'react-router';\nimport {Track} from '@app/web-player/tracks/track';\nimport {assignAlbumToTracks} from '@app/web-player/albums/assign-album-to-tracks';\nimport {getBootstrapData} from '@ui/bootstrap-data/bootstrap-data-store';\n\nexport interface getTrackResponse extends BackendResponse {\n  track: Track;\n  loader: Params['loader'];\n}\n\ninterface Params {\n  loader: 'track' | 'trackPage' | 'editTrackPage';\n}\n\nexport function useTrack(params: Params) {\n  const {trackId} = useParams();\n  return useQuery({\n    queryKey: ['tracks', +trackId!, params],\n    queryFn: () => fetchTrack(trackId!, params),\n    initialData: () => {\n      const data = getBootstrapData().loaders?.[params.loader];\n      if (data?.track?.id == trackId && data?.loader === params.loader) {\n        return data;\n      }\n      return undefined;\n    },\n  });\n}\n\nfunction fetchTrack(trackId: number | string, params: Params) {\n  return apiClient\n    .get<getTrackResponse>(`tracks/${trackId}`, {params})\n    .then(response => {\n      if (response.data.track.album) {\n        response.data.track = {\n          ...response.data.track,\n          album: assignAlbumToTracks(response.data.track.album),\n        };\n      }\n      return response.data;\n    });\n}\n","import {useMemo} from 'react';\nimport {useAuth} from '@common/auth/use-auth';\nimport {Track} from '@app/web-player/tracks/track';\n\nexport function useTrackPermissions(tracks: (Track | undefined)[]) {\n  const {user, hasPermission} = useAuth();\n\n  return useMemo(() => {\n    const permissions = {\n      canEdit: true,\n      canDelete: true,\n      managesTrack: true,\n    };\n    tracks.every(track => {\n      if (!track) {\n        permissions.canEdit = false;\n        permissions.canDelete = false;\n        permissions.managesTrack = false;\n        return;\n      }\n\n      const trackArtistIds = track.artists?.map(a => a.id);\n      const managesTrack =\n        track.owner_id === user?.id ||\n        !!user?.artists?.find(a => trackArtistIds?.includes(a.id as number));\n\n      if (!managesTrack) {\n        permissions.managesTrack = false;\n      }\n\n      if (\n        !hasPermission('tracks.update') &&\n        !hasPermission('music.update') &&\n        !managesTrack\n      ) {\n        permissions.canEdit = false;\n      }\n\n      if (\n        !hasPermission('tracks.delete') &&\n        !hasPermission('music.delete') &&\n        !managesTrack\n      ) {\n        permissions.canDelete = false;\n      }\n    });\n    return permissions;\n  }, [user, tracks, hasPermission]);\n}\n","import {Album} from '@app/web-player/albums/album';\nimport {useMemo} from 'react';\nimport {useAuth} from '@common/auth/use-auth';\n\nexport function useAlbumPermissions(album?: Album) {\n  const {user, hasPermission} = useAuth();\n  return useMemo(() => {\n    const permissions = {\n      canEdit: false,\n      canDelete: false,\n      managesAlbum: false,\n    };\n    if (user?.id && album) {\n      const albumArtistIds = album.artists?.map(a => a.id);\n      const managesAlbum =\n        album.owner_id === user.id ||\n        !!user.artists?.find(a => albumArtistIds?.includes(a.id as number));\n\n      permissions.canEdit =\n        hasPermission('albums.update') ||\n        hasPermission('music.update') ||\n        managesAlbum;\n\n      permissions.canDelete =\n        hasPermission('albums.delete') ||\n        hasPermission('music.delete') ||\n        managesAlbum;\n\n      permissions.managesAlbum = managesAlbum;\n    }\n    return permissions;\n  }, [user, album, hasPermission]);\n}\n","import {isMac} from '@react-aria/utils';\n\ninterface Event {\n  altKey: boolean;\n  ctrlKey: boolean;\n  metaKey: boolean;\n}\n\nexport function isCtrlKeyPressed(e: Event) {\n  if (isMac()) {\n    return e.metaKey;\n  }\n\n  return e.ctrlKey;\n}\n","import React, {KeyboardEventHandler} from 'react';\nimport {getFocusableTreeWalker} from '@react-aria/focus';\nimport {focusWithoutScrolling} from '@react-aria/utils';\nimport {isCtrlKeyPressed} from '@ui/utils/keybinds/is-ctrl-key-pressed';\n\ninterface Props {\n  cellCount: number;\n  rowCount: number;\n}\nexport function useGridNavigation(props: Props) {\n  const {cellCount, rowCount} = props;\n  const onKeyDown: KeyboardEventHandler<HTMLElement> = e => {\n    switch (e.key) {\n      case 'ArrowLeft':\n        focusSiblingCell(e, {cell: {op: 'decrement'}}, props);\n        break;\n      case 'ArrowRight':\n        focusSiblingCell(e, {cell: {op: 'increment'}}, props);\n        break;\n      case 'ArrowUp':\n        focusSiblingCell(e, {row: {op: 'decrement'}}, props);\n        break;\n      case 'ArrowDown':\n        focusSiblingCell(e, {row: {op: 'increment'}}, props);\n        break;\n      case 'PageUp':\n        focusSiblingCell(e, {row: {op: 'decrement', count: 5}}, props);\n        break;\n      case 'PageDown':\n        focusSiblingCell(e, {row: {op: 'increment', count: 5}}, props);\n        break;\n      case 'Tab':\n        focusFirstElementAfterGrid(e);\n        break;\n      case 'Home':\n        if (isCtrlKeyPressed(e)) {\n          // move to first cell in first row\n          focusSiblingCell(\n            e,\n            {\n              row: {op: 'decrement', count: rowCount},\n              cell: {op: 'decrement', count: cellCount},\n            },\n            props,\n          );\n        } else {\n          // move to first cell in current row\n          focusSiblingCell(\n            e,\n            {cell: {op: 'decrement', count: cellCount}},\n            props,\n          );\n        }\n        break;\n      case 'End':\n        if (isCtrlKeyPressed(e)) {\n          // move to last cell in last row\n          focusSiblingCell(\n            e,\n            {\n              row: {op: 'increment', count: rowCount},\n              cell: {op: 'increment', count: cellCount},\n            },\n            props,\n          );\n        } else {\n          // move to last cell in current row\n          focusSiblingCell(\n            e,\n            {cell: {op: 'increment', count: cellCount}},\n            props,\n          );\n        }\n        break;\n    }\n  };\n\n  return {onKeyDown};\n}\n\ninterface Operations {\n  cell?: {\n    op: 'increment' | 'decrement';\n    count?: number;\n  };\n  row?: {\n    op: 'increment' | 'decrement';\n    count?: number;\n  };\n}\nfunction focusSiblingCell(\n  e: React.KeyboardEvent,\n  operations: Operations,\n  {cellCount, rowCount}: Props,\n) {\n  if (document.activeElement?.tagName === 'input') return;\n  e.preventDefault();\n  const grid = e.currentTarget as HTMLElement;\n\n  // focused element might be inside the cell and not the cell itself\n  const currentCell = (e.target as HTMLElement).closest('[aria-colindex]');\n  if (!currentCell || !grid) return;\n\n  const row = currentCell.closest('[aria-rowindex]');\n  if (!row) return;\n\n  // grab row and cell index from aria attributes\n  let rowIndex = parseInt(row.getAttribute('aria-rowindex') as string);\n  let cellIndex = parseInt(currentCell.getAttribute('aria-colindex') as string);\n  if (Number.isNaN(rowIndex) || Number.isNaN(cellIndex)) return;\n\n  // adjust row index for next cell selector\n  const rowOpCount = operations.row?.count ?? 1;\n  if (operations.row?.op === 'increment') {\n    rowIndex = Math.min(rowCount, rowIndex + rowOpCount);\n  } else if (operations.row?.op === 'decrement') {\n    rowIndex = Math.max(1, rowIndex - rowOpCount);\n  }\n\n  // adjust cell index for next cell selector\n  const cellOpCount = operations.cell?.count ?? 1;\n  if (operations.cell?.op === 'increment') {\n    cellIndex = Math.min(cellCount, cellIndex + cellOpCount);\n  } else if (operations.cell?.op === 'decrement') {\n    cellIndex = Math.max(1, cellIndex - cellOpCount);\n  }\n\n  // find the next cell that should be focused\n  const nextCell = grid.querySelector(\n    `[aria-rowindex=\"${rowIndex}\"] [aria-colindex=\"${cellIndex}\"]`,\n  ) as HTMLElement | undefined;\n  if (!nextCell) return;\n\n  // find any focusable elements inside the cell\n  const walker = getFocusableTreeWalker(nextCell);\n  const nextFocusableElement = (walker.nextNode() || nextCell) as HTMLElement;\n\n  // adjust tab index on current and next cells and focus either next cell or first focusable element inside that cell\n  currentCell.setAttribute('tabindex', '-1');\n  nextFocusableElement.setAttribute('tabindex', '0');\n  nextFocusableElement.focus();\n}\n\n// grid is treated as a single tab stop, focus first element after grid, instead of moving focus withing grid on tab press\nfunction focusFirstElementAfterGrid(e: React.KeyboardEvent) {\n  const grid = e.currentTarget as HTMLElement;\n  if (e.shiftKey) {\n    grid.focus();\n  } else {\n    const walker = getFocusableTreeWalker(grid, {tabbable: true});\n    let next: HTMLElement;\n    let last: HTMLElement;\n    do {\n      last = walker.lastChild() as HTMLElement;\n      if (last) {\n        next = last;\n      }\n    } while (last);\n\n    // @ts-ignore\n    if (next && !next.contains(document.activeElement)) {\n      focusWithoutScrolling(next);\n    }\n  }\n}\n","import {createContext} from 'react';\nimport type {SortDescriptor} from './types/sort-descriptor';\nimport type {TableProps} from './table';\nimport type {ColumnConfig} from '../../datatable/column-config';\nimport type {TableDataItem} from './types/table-data-item';\n\nexport type TableSelectionStyle = 'checkbox' | 'highlight';\n\nexport interface TableContextValue<T extends TableDataItem = TableDataItem> {\n  isCollapsedMode: boolean;\n  selectedRows: (string | number)[];\n  onSelectionChange: (keys: (string | number)[]) => void;\n  sortDescriptor?: SortDescriptor;\n  onSortChange?: (descriptor: SortDescriptor) => any;\n  enableSelection?: boolean;\n  enableSorting?: boolean;\n  selectionStyle: TableSelectionStyle;\n  data: T[];\n  meta?: any;\n  columns: ColumnConfig<T>[];\n  toggleRow: (item: T) => void;\n  selectRow: (item: T | null, merge?: boolean) => void;\n  hideBorder: boolean;\n  hideHeaderRow: boolean;\n  collapseOnMobile: boolean;\n  onAction: TableProps<T>['onAction'];\n  selectRowOnContextMenu: TableProps<T>['selectRowOnContextMenu'];\n  cellHeight: string | undefined;\n  headerCellHeight: string | undefined;\n}\nexport const TableContext = createContext<TableContextValue>(null!);\n","import clsx from 'clsx';\nimport {useContext} from 'react';\nimport {TableContext} from '@common/ui/tables/table-context';\n\ninterface Props {\n  index: number;\n  isHeader: boolean;\n}\nexport function useTableCellStyle({index, isHeader}: Props) {\n  const {\n    columns,\n    cellHeight = 'h-46',\n    headerCellHeight = 'h-46',\n  } = useContext(TableContext);\n  const column = columns[index];\n\n  const userPadding = column?.padding;\n\n  let justify = 'justify-start';\n  if (column?.align === 'center') {\n    justify = 'justify-center';\n  } else if (column?.align === 'end') {\n    justify = 'justify-end';\n  }\n\n  return clsx(\n    'flex items-center overflow-hidden whitespace-nowrap overflow-ellipsis outline-none focus-visible:outline focus-visible:outline-offset-2',\n    isHeader ? headerCellHeight : cellHeight,\n    column?.width ?? 'flex-1',\n    column?.maxWidth,\n    column?.minWidth,\n    justify,\n    userPadding,\n    column?.className\n  );\n}\n","import {useContext, useMemo} from 'react';\nimport {TableContext} from './table-context';\nimport {TableDataItem} from './types/table-data-item';\nimport {RowContext} from '@common/datatable/column-config';\nimport {useTableCellStyle} from '@common/ui/tables/style/use-table-cell-style';\n\ninterface TableCellProps {\n  rowIsHovered: boolean;\n  rowIndex: number;\n  index: number;\n  item: TableDataItem;\n  id?: string;\n}\nexport function TableCell({\n  rowIndex,\n  rowIsHovered,\n  index,\n  item,\n  id,\n}: TableCellProps) {\n  const {columns} = useContext(TableContext);\n  const column = columns[index];\n\n  const rowContext: RowContext = useMemo(() => {\n    return {\n      index: rowIndex,\n      isHovered: rowIsHovered,\n      isPlaceholder: item.isPlaceholder,\n    };\n  }, [rowIndex, rowIsHovered, item.isPlaceholder]);\n\n  const style = useTableCellStyle({\n    index: index,\n    isHeader: false,\n  });\n\n  return (\n    <div\n      tabIndex={-1}\n      role=\"gridcell\"\n      aria-colindex={index + 1}\n      id={id}\n      className={style}\n    >\n      <div className=\"w-full min-w-0 overflow-hidden overflow-ellipsis\">\n        {column.body(item, rowContext)}\n      </div>\n    </div>\n  );\n}\n","import {isCtrlKeyPressed} from '@ui/utils/keybinds/is-ctrl-key-pressed';\n\ninterface Event {\n  altKey: boolean;\n  ctrlKey: boolean;\n  metaKey: boolean;\n  shiftKey: boolean;\n}\n\nexport function isCtrlOrShiftPressed(e: Event) {\n  return e.shiftKey || isCtrlKeyPressed(e);\n}\n","import clsx from 'clsx';\nimport {useContext} from 'react';\nimport {TableContext} from '@common/ui/tables/table-context';\nimport {useIsDarkMode} from '@ui/themes/use-is-dark-mode';\nimport {useIsMobileMediaQuery} from '@ui/utils/hooks/is-mobile-media-query';\n\ninterface Props {\n  index: number;\n  isSelected: boolean;\n  isHeader?: boolean;\n}\nexport function useTableRowStyle({index, isSelected, isHeader}: Props) {\n  const isDarkMode = useIsDarkMode();\n  const isMobile = useIsMobileMediaQuery();\n  const {hideBorder, enableSelection, collapseOnMobile, onAction} =\n    useContext(TableContext);\n  const isFirst = index === 0;\n  return clsx(\n    'flex gap-x-16 break-inside-avoid outline-none border border-transparent',\n    onAction && 'cursor-pointer',\n    isMobile && collapseOnMobile && hideBorder\n      ? 'mb-8 pl-8 pr-0 rounded'\n      : 'px-16',\n    !hideBorder && 'border-b-divider',\n    !hideBorder && isFirst && 'border-t-divider',\n    isSelected &&\n      !isDarkMode &&\n      'bg-primary/selected hover:bg-primary/focus focus-visible:bg-primary/focus',\n    isSelected &&\n      isDarkMode &&\n      'bg-selected hover:bg-focus focus-visible:bg-focus',\n    !isSelected &&\n      !isHeader &&\n      (enableSelection || onAction) &&\n      'focus-visible:bg-focus hover:bg-hover',\n  );\n}\n","import React, {HTMLAttributes, useRef} from 'react';\nimport {useGlobalListeners} from '@react-aria/utils';\nimport {createEventHandler} from '@ui/utils/dom/create-event-handler';\n\ninterface PointerState {\n  lastPosition: {x: number; y: number};\n  id?: number;\n  started: boolean;\n  el?: HTMLElement;\n  originalTouchAction?: string;\n  originalUserSelect?: string;\n  longPressTimer?: any;\n  longPressTriggered?: boolean;\n}\n\ninterface UsePointerEventsReturn {\n  domProps: HTMLAttributes<HTMLElement>;\n}\n\nexport interface UsePointerEventsProps {\n  onMoveStart?: (e: PointerEvent, el: HTMLElement) => false | void;\n  onMove?: (e: PointerEvent, deltaX: number, deltaY: number) => void;\n  onMoveEnd?: (e: PointerEvent) => void;\n  onPointerDown?: (e: React.PointerEvent) => void | false;\n  onPointerUp?: (e: PointerEvent, el: HTMLElement) => void;\n  onPress?: (e: PointerEvent, el: HTMLElement) => void;\n  onLongPress?: (e: PointerEvent | React.PointerEvent, el: HTMLElement) => void;\n  preventDefault?: boolean;\n  stopPropagation?: boolean;\n  minimumMovement?: number;\n}\nexport function usePointerEvents({\n  onMoveStart,\n  onMove,\n  onMoveEnd,\n  minimumMovement = 0,\n  preventDefault,\n  stopPropagation = true,\n  onPress,\n  onLongPress,\n  ...props\n}: UsePointerEventsProps): UsePointerEventsReturn {\n  const stateRef = useRef<PointerState>({\n    lastPosition: {x: 0, y: 0},\n    started: false,\n    longPressTriggered: false,\n  });\n  const state = stateRef.current;\n\n  const {addGlobalListener, removeGlobalListener} = useGlobalListeners();\n\n  const start = (e: PointerEvent) => {\n    if (!state.el) return;\n    const result = onMoveStart?.(e, state.el);\n\n    // allow user to cancel interaction\n    if (result === false) return;\n\n    state.originalTouchAction = state.el.style.touchAction;\n    state.el.style.touchAction = 'none';\n    state.originalUserSelect = document.documentElement.style.userSelect;\n    document.documentElement.style.userSelect = 'none';\n    state.started = true;\n  };\n\n  const onPointerDown = (e: React.PointerEvent) => {\n    if (e.button === 0 && state.id == null) {\n      state.started = false;\n\n      const result = props.onPointerDown?.(e);\n      if (result === false) return;\n\n      if (stopPropagation) {\n        e.stopPropagation();\n      }\n      if (preventDefault) {\n        e.preventDefault();\n      }\n      state.id = e.pointerId;\n      state.el = e.currentTarget as HTMLElement;\n      state.lastPosition = {x: e.clientX, y: e.clientY};\n\n      // use global listeners, so we don't have to capture pointer,\n      // which would prevent click events on child nodes\n\n      if (onLongPress) {\n        state.longPressTimer = setTimeout(() => {\n          onLongPress(e, state.el!);\n          state.longPressTriggered = true;\n        }, 400);\n      }\n\n      if (onMoveStart || onMove) {\n        addGlobalListener(window, 'pointermove', onPointerMove, false);\n      }\n      addGlobalListener(window, 'pointerup', onPointerUp, false);\n      addGlobalListener(window, 'pointercancel', onPointerUp, false);\n    }\n  };\n\n  const onPointerMove = (e: PointerEvent) => {\n    if (e.pointerId === state.id) {\n      const deltaX = e.clientX - state.lastPosition.x;\n      const deltaY = e.clientY - state.lastPosition.y;\n\n      if (\n        (Math.abs(deltaX) >= minimumMovement ||\n          Math.abs(deltaY) >= minimumMovement) &&\n        !state.started\n      ) {\n        start(e);\n      }\n\n      if (state.started) {\n        onMove?.(e, deltaX, deltaY);\n        state.lastPosition = {x: e.clientX, y: e.clientY};\n      }\n    }\n  };\n\n  const onPointerUp = (e: PointerEvent) => {\n    if (e.pointerId === state.id) {\n      // cancel long press timer, if exists\n      if (state.longPressTimer) {\n        clearTimeout(state.longPressTimer);\n      }\n\n      const longPressTriggered = state.longPressTriggered;\n      state.longPressTriggered = false;\n\n      // only call onMoveEnd if we actually started moving\n      if (state.started) {\n        onMoveEnd?.(e);\n      }\n\n      if (state.el) {\n        // handle press only if event was not cancelled (via touch scroll on mobile for example)\n        if (e.type !== 'pointercancel') {\n          props.onPointerUp?.(e, state.el);\n\n          // only call onPress if pointer did not leave onPointerDown element\n          if (e.target && state.el.contains(e.target as HTMLElement)) {\n            // trigger either onPress or onLongPress\n            if (longPressTriggered) {\n              onLongPress?.(e, state.el);\n            } else {\n              onPress?.(e, state.el);\n            }\n          }\n        }\n\n        document.documentElement.style.userSelect =\n          state.originalUserSelect || '';\n        state.el.style.touchAction = state.originalTouchAction || '';\n      }\n      state.id = undefined;\n      state.started = false;\n      removeGlobalListener(window, 'pointermove', onPointerMove, false);\n      removeGlobalListener(window, 'pointerup', onPointerUp, false);\n      removeGlobalListener(window, 'pointercancel', onPointerUp, false);\n    }\n  };\n\n  return {\n    domProps: {\n      onPointerDown: createEventHandler(onPointerDown),\n    },\n  };\n}\n","import React, {\n  ComponentPropsWithoutRef,\n  JSXElementConstructor,\n  KeyboardEventHandler,\n  MouseEventHandler,\n  useContext,\n  useRef,\n  useState,\n} from 'react';\nimport {TableContext} from '@common/ui/tables/table-context';\nimport {TableCell} from '@common/ui/tables/table-cell';\nimport {TableDataItem} from '@common/ui/tables/types/table-data-item';\nimport {createEventHandler} from '@ui/utils/dom/create-event-handler';\nimport {isCtrlOrShiftPressed} from '@ui/utils/keybinds/is-ctrl-or-shift-pressed';\nimport {useTableRowStyle} from '@common/ui/tables/style/use-table-row-style';\nimport clsx from 'clsx';\nimport {usePointerEvents} from '@ui/interactions/use-pointer-events';\n\nconst interactableElements = ['button', 'a', 'input', 'select', 'textarea'];\n\nexport interface RowElementProps<T = TableDataItem>\n  extends ComponentPropsWithoutRef<'tr'> {\n  item: T & {isPlaceholder?: boolean};\n}\n\ninterface TableRowProps {\n  item: TableDataItem;\n  index: number;\n  renderAs?: JSXElementConstructor<RowElementProps>;\n  className?: string;\n  style?: React.CSSProperties;\n}\nexport function TableRow({\n  item,\n  index,\n  renderAs,\n  className,\n  style,\n}: TableRowProps) {\n  const {\n    selectedRows,\n    columns,\n    toggleRow,\n    selectRow,\n    onAction,\n    selectRowOnContextMenu,\n    enableSelection,\n    selectionStyle,\n    hideHeaderRow,\n  } = useContext(TableContext);\n\n  const isTouchDevice = useRef(false);\n  const isSelected = selectedRows.includes(item.id);\n  const [isHovered, setIsHovered] = useState(false);\n\n  const clickedOnInteractable = (e: React.MouseEvent | PointerEvent) => {\n    return (e.target as HTMLElement).closest(interactableElements.join(','));\n  };\n\n  const doubleClickHandler: MouseEventHandler<HTMLDivElement> = e => {\n    if (\n      selectionStyle === 'highlight' &&\n      onAction &&\n      !isTouchDevice.current &&\n      !clickedOnInteractable(e)\n    ) {\n      e.preventDefault();\n      e.stopPropagation();\n      onAction(item, index);\n    }\n  };\n\n  const anyRowsSelected = !!selectedRows.length;\n\n  const handleRowTap = (e: PointerEvent) => {\n    if (clickedOnInteractable(e)) return;\n    if (selectionStyle === 'checkbox') {\n      if (enableSelection && (anyRowsSelected || !onAction)) {\n        toggleRow(item);\n      } else if (onAction) {\n        onAction(item, index);\n      }\n    } else if (selectionStyle === 'highlight') {\n      if (isTouchDevice.current) {\n        if (enableSelection && anyRowsSelected) {\n          toggleRow(item);\n        } else {\n          onAction?.(item, index);\n        }\n      } else if (enableSelection) {\n        selectRow(item, isCtrlOrShiftPressed(e));\n      }\n    }\n  };\n\n  const {domProps} = usePointerEvents({\n    onPointerDown: e => {\n      isTouchDevice.current = e.pointerType === 'touch';\n    },\n    onPress: handleRowTap,\n    onLongPress: enableSelection\n      ? () => {\n          if (isTouchDevice.current) {\n            toggleRow(item);\n          }\n        }\n      : undefined,\n  });\n\n  const keyboardHandler: KeyboardEventHandler = e => {\n    if (enableSelection && e.key === ' ') {\n      e.preventDefault();\n      e.stopPropagation();\n      if (selectionStyle === 'checkbox') {\n        toggleRow(item);\n      } else {\n        selectRow(item);\n      }\n    } else if (e.key === 'Enter' && !selectedRows.length && onAction) {\n      e.preventDefault();\n      e.stopPropagation();\n      onAction(item, index);\n    }\n  };\n\n  const contextMenuHandler: MouseEventHandler = e => {\n    if (selectRowOnContextMenu && enableSelection) {\n      if (!selectedRows.includes(item.id)) {\n        selectRow(item);\n      }\n    }\n    // prevent context menu on mobile\n    if (isTouchDevice.current) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  };\n\n  const styleClassName = useTableRowStyle({index, isSelected});\n\n  const RowElement = renderAs || 'div';\n  return (\n    <RowElement\n      role=\"row\"\n      aria-rowindex={index + 1 + (hideHeaderRow ? 0 : 1)}\n      aria-selected={isSelected}\n      tabIndex={-1}\n      className={clsx(className, styleClassName)}\n      item={RowElement === 'div' ? (undefined as any) : item}\n      onDoubleClick={createEventHandler(doubleClickHandler)}\n      onKeyDown={createEventHandler(keyboardHandler)}\n      onContextMenu={createEventHandler(contextMenuHandler)}\n      onPointerEnter={createEventHandler(() => setIsHovered(true))}\n      onPointerLeave={createEventHandler(() => setIsHovered(false))}\n      style={style}\n      {...domProps}\n    >\n      {columns.map((column, cellIndex) => (\n        <TableCell\n          rowIndex={index}\n          rowIsHovered={isHovered}\n          index={cellIndex}\n          item={item}\n          key={`${item.id}-${column.key}`}\n        />\n      ))}\n    </RowElement>\n  );\n}\n","import {ColumnConfig} from '@common/datatable/column-config';\nimport {TableDataItem} from '@common/ui/tables/types/table-data-item';\nimport {Skeleton} from '@ui/skeleton/skeleton';\nimport React, {useContext} from 'react';\nimport {Checkbox} from '@ui/forms/toggle/checkbox';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {TableContext} from '@common/ui/tables/table-context';\n\nexport const CheckboxColumnConfig: ColumnConfig<TableDataItem> = {\n  key: 'checkbox',\n  header: () => <SelectAllCheckbox />,\n  align: 'center',\n  width: 'w-24 flex-shrink-0',\n  body: (item, row) => {\n    if (row.isPlaceholder) {\n      return <Skeleton size=\"w-24 h-24\" variant=\"rect\" />;\n    }\n    return <SelectRowCheckbox item={item} />;\n  },\n};\n\ninterface SelectRowCheckboxProps {\n  item: TableDataItem;\n}\nfunction SelectRowCheckbox({item}: SelectRowCheckboxProps) {\n  const {selectedRows, toggleRow} = useContext(TableContext);\n  return (\n    <Checkbox\n      checked={selectedRows.includes(item.id)}\n      onChange={() => toggleRow(item)}\n    />\n  );\n}\n\nfunction SelectAllCheckbox() {\n  const {trans} = useTrans();\n\n  const {data, selectedRows, onSelectionChange} = useContext(TableContext);\n  const allRowsSelected = !!data.length && data.length === selectedRows.length;\n  const someRowsSelected = !allRowsSelected && !!selectedRows.length;\n\n  return (\n    <Checkbox\n      aria-label={trans({message: 'Select all'})}\n      isIndeterminate={someRowsSelected}\n      checked={allRowsSelected}\n      onChange={() => {\n        if (allRowsSelected) {\n          onSelectionChange([]);\n        } else {\n          onSelectionChange(data.map(d => d.id));\n        }\n      }}\n    />\n  );\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const ArrowDownwardIcon = createSvgIcon(\n  <path d=\"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z\" />\n, 'ArrowDownwardOutlined');\n","import {useContext, useState} from 'react';\nimport clsx from 'clsx';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {TableContext} from './table-context';\nimport {SortDescriptor} from './types/sort-descriptor';\nimport {ArrowDownwardIcon} from '@ui/icons/material/ArrowDownward';\nimport {useTableCellStyle} from '@common/ui/tables/style/use-table-cell-style';\n\ninterface HeaderCellProps {\n  index: number;\n}\nexport function HeaderCell({index}: HeaderCellProps) {\n  const {columns, sortDescriptor, onSortChange, enableSorting} =\n    useContext(TableContext);\n  const column = columns[index];\n\n  const style = useTableCellStyle({\n    index: index,\n    isHeader: true,\n  });\n\n  const [isHovered, setIsHovered] = useState(false);\n\n  const sortingKey = column.sortingKey || column.key;\n  const allowSorting = column.allowsSorting && enableSorting;\n  const {orderBy, orderDir} = sortDescriptor || {};\n\n  const sortActive = allowSorting && orderBy === sortingKey;\n\n  let ariaSort: 'ascending' | 'descending' | 'none' | undefined;\n  if (sortActive && orderDir === 'asc') {\n    ariaSort = 'ascending';\n  } else if (sortActive && orderDir === 'desc') {\n    ariaSort = 'descending';\n  } else if (allowSorting) {\n    ariaSort = 'none';\n  }\n\n  const toggleSorting = () => {\n    if (!allowSorting) return;\n\n    let newSort: SortDescriptor;\n\n    // if this col was sorted desc, go to asc\n    if (sortActive && orderDir === 'desc') {\n      newSort = {orderDir: 'asc', orderBy: sortingKey};\n\n      // if this col was sorted asc, clear sort\n    } else if (sortActive && orderDir === 'asc') {\n      newSort = {orderBy: undefined, orderDir: undefined};\n\n      // if sort was on another col, or no sort was applied yet, start from desc\n    } else {\n      newSort = {orderDir: 'desc', orderBy: sortingKey};\n    }\n\n    onSortChange?.(newSort);\n  };\n\n  const sortVisible = sortActive || isHovered;\n  const sortVariants = {\n    visible: {opacity: 1, y: 0},\n    hidden: {opacity: 0, y: '-25%'},\n  };\n\n  return (\n    <div\n      role=\"columnheader\"\n      tabIndex={-1}\n      aria-colindex={index + 1}\n      aria-sort={ariaSort}\n      className={clsx(\n        style,\n        'text-xs font-medium text-muted',\n        allowSorting && 'cursor-pointer',\n      )}\n      onMouseEnter={() => {\n        setIsHovered(true);\n      }}\n      onMouseLeave={() => {\n        setIsHovered(false);\n      }}\n      onKeyDown={e => {\n        if (e.key === ' ' || e.key === 'Enter') {\n          e.preventDefault();\n          toggleSorting();\n        }\n      }}\n      onClick={toggleSorting}\n    >\n      {column.hideHeader ? (\n        <div className=\"opacity-0\">{column.header()}</div>\n      ) : (\n        column.header()\n      )}\n      <AnimatePresence>\n        {allowSorting && (\n          <m.span\n            variants={sortVariants}\n            animate={sortVisible ? 'visible' : 'hidden'}\n            initial={false}\n            transition={{type: 'tween'}}\n            key=\"sort-icon\"\n            className=\"-mt-2 ml-6 inline-block\"\n            data-testid=\"table-sort-button\"\n            aria-hidden={!sortVisible}\n          >\n            <ArrowDownwardIcon\n              size=\"xs\"\n              className={clsx(\n                'text-muted',\n                orderDir === 'asc' &&\n                  orderBy === sortingKey &&\n                  'rotate-180 transition-transform',\n              )}\n            />\n          </m.span>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n","import {HeaderCell} from '@common/ui/tables/header-cell';\nimport React, {useContext} from 'react';\nimport {TableContext} from '@common/ui/tables/table-context';\n\nexport function TableHeaderRow() {\n  const {columns} = useContext(TableContext);\n  return (\n    <div\n      role=\"row\"\n      aria-rowindex={1}\n      tabIndex={-1}\n      className=\"flex gap-x-16 px-16\"\n    >\n      {columns.map((column, columnIndex) => (\n        <HeaderCell index={columnIndex} key={column.key} />\n      ))}\n    </div>\n  );\n}\n","import React, {\n  cloneElement,\n  ComponentPropsWithoutRef,\n  Fragment,\n  JSXElementConstructor,\n  MutableRefObject,\n  ReactElement,\n  useCallback,\n  useContext,\n  useMemo,\n} from 'react';\nimport {useControlledState} from '@react-stately/utils';\nimport {SortDescriptor} from './types/sort-descriptor';\nimport {useGridNavigation} from './navigate-grid';\nimport {RowElementProps, TableRow} from './table-row';\nimport {\n  TableContext,\n  TableContextValue,\n  TableSelectionStyle,\n} from './table-context';\nimport {ColumnConfig} from '../../datatable/column-config';\nimport {TableDataItem} from './types/table-data-item';\nimport clsx from 'clsx';\nimport {useInteractOutside} from '@react-aria/interactions';\nimport {mergeProps, useObjectRef} from '@react-aria/utils';\nimport {isCtrlKeyPressed} from '@ui/utils/keybinds/is-ctrl-key-pressed';\nimport {useIsMobileMediaQuery} from '@ui/utils/hooks/is-mobile-media-query';\nimport {CheckboxColumnConfig} from '@common/ui/tables/checkbox-column-config';\nimport {TableHeaderRow} from '@common/ui/tables/table-header-row';\n\nexport interface TableProps<T extends TableDataItem>\n  extends ComponentPropsWithoutRef<'table'> {\n  className?: string;\n  columns: ColumnConfig<T>[];\n  hideHeaderRow?: boolean;\n  data: T[];\n  meta?: any;\n  tableRef?: MutableRefObject<HTMLTableElement>;\n  selectedRows?: (number | string)[];\n  defaultSelectedRows?: (number | string)[];\n  onSelectionChange?: (keys: (number | string)[]) => void;\n  sortDescriptor?: SortDescriptor;\n  onSortChange?: (descriptor: SortDescriptor) => any;\n  enableSorting?: boolean;\n  onDelete?: (items: T[]) => void;\n  enableSelection?: boolean;\n  selectionStyle?: TableSelectionStyle;\n  ariaLabelledBy?: string;\n  onAction?: (item: T, index: number) => void;\n  selectRowOnContextMenu?: boolean;\n  renderRowAs?: JSXElementConstructor<RowElementProps<T>>;\n  tableBody?: ReactElement<TableBodyProps>;\n  hideBorder?: boolean;\n  closeOnInteractOutside?: boolean;\n  collapseOnMobile?: boolean;\n  cellHeight?: string;\n  headerCellHeight?: string;\n}\nexport function Table<T extends TableDataItem>({\n  className,\n  columns: userColumns,\n  collapseOnMobile = true,\n  hideHeaderRow = false,\n  hideBorder = false,\n  data,\n  selectedRows: propsSelectedRows,\n  defaultSelectedRows: propsDefaultSelectedRows,\n  onSelectionChange: propsOnSelectionChange,\n  sortDescriptor: propsSortDescriptor,\n  onSortChange: propsOnSortChange,\n  enableSorting = true,\n  onDelete,\n  enableSelection = true,\n  selectionStyle = 'checkbox',\n  ariaLabelledBy,\n  selectRowOnContextMenu,\n  onAction,\n  renderRowAs,\n  tableBody,\n  meta,\n  tableRef: propsTableRef,\n  closeOnInteractOutside = false,\n  cellHeight,\n  headerCellHeight,\n  ...domProps\n}: TableProps<T>) {\n  const isMobile = useIsMobileMediaQuery();\n  const isCollapsedMode = !!isMobile && collapseOnMobile;\n  if (isCollapsedMode) {\n    hideHeaderRow = true;\n    hideBorder = true;\n  }\n\n  const [selectedRows, onSelectionChange] = useControlledState(\n    propsSelectedRows,\n    propsDefaultSelectedRows || [],\n    propsOnSelectionChange,\n  );\n\n  const [sortDescriptor, onSortChange] = useControlledState(\n    propsSortDescriptor,\n    undefined,\n    propsOnSortChange,\n  );\n\n  const toggleRow = useCallback(\n    (item: TableDataItem) => {\n      const newValues = [...selectedRows];\n      if (!newValues.includes(item.id)) {\n        newValues.push(item.id);\n      } else {\n        const index = newValues.indexOf(item.id);\n        newValues.splice(index, 1);\n      }\n      onSelectionChange(newValues);\n    },\n    [selectedRows, onSelectionChange],\n  );\n\n  const selectRow = useCallback(\n    // allow deselecting all rows by passing in null\n    (item: TableDataItem | null, merge?: boolean) => {\n      let newValues: (string | number)[] = [];\n      if (item) {\n        newValues = merge\n          ? [...selectedRows?.filter(id => id !== item.id), item.id]\n          : [item.id];\n      }\n      onSelectionChange(newValues);\n    },\n    [selectedRows, onSelectionChange],\n  );\n\n  // add checkbox columns to config, if selection is enabled\n  const columns = useMemo(() => {\n    const filteredColumns = userColumns.filter(c => {\n      const visibleInMode = c.visibleInMode || 'regular';\n      if (visibleInMode === 'all') {\n        return true;\n      }\n      if (visibleInMode === 'compact' && isCollapsedMode) {\n        return true;\n      }\n      if (visibleInMode === 'regular' && !isCollapsedMode) {\n        return true;\n      }\n    });\n    const showCheckboxCell =\n      enableSelection && selectionStyle !== 'highlight' && !isMobile;\n    if (showCheckboxCell) {\n      filteredColumns.unshift(CheckboxColumnConfig);\n    }\n    return filteredColumns;\n  }, [isMobile, userColumns, enableSelection, selectionStyle, isCollapsedMode]);\n\n  const contextValue: TableContextValue<T> = {\n    isCollapsedMode,\n    cellHeight,\n    headerCellHeight,\n    hideBorder,\n    hideHeaderRow,\n    selectedRows,\n    onSelectionChange,\n    enableSorting,\n    enableSelection,\n    selectionStyle,\n    data,\n    columns,\n    sortDescriptor,\n    onSortChange,\n    toggleRow,\n    selectRow,\n    onAction,\n    selectRowOnContextMenu,\n    meta,\n    collapseOnMobile,\n  };\n\n  const navProps = useGridNavigation({\n    cellCount: enableSelection ? columns.length + 1 : columns.length,\n    rowCount: data.length + 1,\n  });\n\n  const tableBodyProps: TableBodyProps = {\n    renderRowAs: renderRowAs as any,\n  };\n\n  if (!tableBody) {\n    tableBody = <BasicTableBody {...tableBodyProps} />;\n  } else {\n    tableBody = cloneElement(tableBody, tableBodyProps);\n  }\n\n  // deselect rows when clicking outside the table\n  const tableRef = useObjectRef(propsTableRef);\n  useInteractOutside({\n    ref: tableRef,\n    onInteractOutside: e => {\n      if (\n        closeOnInteractOutside &&\n        enableSelection &&\n        selectedRows?.length &&\n        // don't deselect if clicking on a dialog (for example is table row has a context menu)\n        !(e.target as HTMLElement).closest('[role=\"dialog\"]')\n      ) {\n        onSelectionChange([]);\n      }\n    },\n  });\n\n  return (\n    <TableContext.Provider value={contextValue as any}>\n      <div\n        {...mergeProps(domProps, navProps, {\n          onKeyDown: (e: KeyboardEvent) => {\n            if (e.key === 'Escape') {\n              e.preventDefault();\n              e.stopPropagation();\n              if (selectedRows?.length) {\n                onSelectionChange([]);\n              }\n            } else if (e.key === 'Delete') {\n              e.preventDefault();\n              e.stopPropagation();\n              if (selectedRows?.length) {\n                onDelete?.(\n                  data.filter(item => selectedRows?.includes(item.id)),\n                );\n              }\n            } else if (isCtrlKeyPressed(e) && e.key === 'a') {\n              e.preventDefault();\n              e.stopPropagation();\n              if (enableSelection) {\n                onSelectionChange(data.map(item => item.id));\n              }\n            }\n          },\n        })}\n        role=\"grid\"\n        tabIndex={0}\n        aria-rowcount={data.length + 1}\n        aria-colcount={columns.length + 1}\n        ref={tableRef}\n        aria-multiselectable={enableSelection ? true : undefined}\n        aria-labelledby={ariaLabelledBy}\n        className={clsx(\n          className,\n          'isolate select-none text-sm outline-none focus-visible:ring-2',\n        )}\n      >\n        {!hideHeaderRow && <TableHeaderRow />}\n        {tableBody}\n      </div>\n    </TableContext.Provider>\n  );\n}\n\nexport interface TableBodyProps {\n  renderRowAs?: TableProps<TableDataItem>['renderRowAs'];\n}\nfunction BasicTableBody({renderRowAs}: TableBodyProps) {\n  const {data} = useContext(TableContext);\n  return (\n    <Fragment>\n      {data.map((item, rowIndex) => (\n        <TableRow\n          item={item}\n          index={rowIndex}\n          key={item.id}\n          renderAs={renderRowAs}\n        />\n      ))}\n    </Fragment>\n  );\n}\n","import dot from 'dot-object';\n\nconst MAX_SAFE_INTEGER = 9007199254740991;\n\nexport function sortArrayOfObjects<T extends object>(\n  data: T[],\n  orderBy: string,\n  orderDir: 'asc' | 'desc' = 'desc'\n): T[] {\n  return data.sort((a, b) => {\n    let valueA = sortingDataAccessor(a, orderBy);\n    let valueB = sortingDataAccessor(b, orderBy);\n\n    // If there are data in the column that can be converted to a number,\n    // it must be ensured that the rest of the data\n    // is of the same type so as not to order incorrectly.\n    const valueAType = typeof valueA;\n    const valueBType = typeof valueB;\n\n    if (valueAType !== valueBType) {\n      if (valueAType === 'number') {\n        valueA += '';\n      }\n      if (valueBType === 'number') {\n        valueB += '';\n      }\n    }\n\n    // If both valueA and valueB exist (truthy), then compare the two. Otherwise, check if\n    // one value exists while the other doesn't. In this case, existing value should come last.\n    // This avoids inconsistent results when comparing values to undefined/null.\n    // If neither value exists, return 0 (equal).\n    let comparatorResult = 0;\n    if (valueA != null && valueB != null) {\n      // Check if one value is greater than the other; if equal, comparatorResult should remain 0.\n      if (valueA > valueB) {\n        comparatorResult = 1;\n      } else if (valueA < valueB) {\n        comparatorResult = -1;\n      }\n    } else if (valueA != null) {\n      comparatorResult = 1;\n    } else if (valueB != null) {\n      comparatorResult = -1;\n    }\n\n    return comparatorResult * (orderDir === 'asc' ? 1 : -1);\n  });\n}\n\n/**\n * Data accessor function that is used for accessing data properties for sorting through\n * the default sortData function.\n * This default function assumes that the sort header IDs (which defaults to the column name)\n * matches the data's properties (e.g. column Xyz represents data['Xyz']).\n * May be set to a custom function for different behavior.\n */\nfunction sortingDataAccessor(data: object, key: string): string {\n  const value = dot.pick(key, data);\n\n  if (isNumberValue(value)) {\n    const numberValue = Number(value);\n\n    // Numbers beyond `MAX_SAFE_INTEGER` can't be compared reliably, so we\n    // leave them as strings. For more info: https://goo.gl/y5vbSg\n    return numberValue < MAX_SAFE_INTEGER ? numberValue : value;\n  }\n\n  return value;\n}\n\nfunction isNumberValue(value: any): boolean {\n  // parseFloat(value) handles most of the cases we're interested in (it treats null, empty string,\n  // and other non-number values as NaN, where Number just uses 0) but it considers the string\n  // '123hello' to be a valid number. Therefore, we also check if Number(value) is NaN.\n  return !isNaN(parseFloat(value as any)) && !isNaN(Number(value));\n}\n","import {useMemo, useState} from 'react';\nimport {SortDescriptor} from '@common/ui/tables/types/sort-descriptor';\nimport {sortArrayOfObjects} from '@ui/utils/array/sort-array-of-objects';\nimport {TableDataItem} from '@common/ui/tables/types/table-data-item';\nimport {TableProps} from '@common/ui/tables/table';\n\nexport function useSortableTableData<T extends TableDataItem>(\n  data?: T[],\n): {\n  data: T[];\n  sortDescriptor: TableProps<T>['sortDescriptor'];\n  onSortChange: TableProps<T>['onSortChange'];\n} {\n  const [sortDescriptor, onSortChange] = useState<SortDescriptor>({});\n  const sortedData: T[] = useMemo(() => {\n    if (!data) {\n      return [];\n    } else if (sortDescriptor?.orderBy) {\n      return sortArrayOfObjects(\n        [...data],\n        sortDescriptor.orderBy,\n        sortDescriptor.orderDir,\n      );\n    }\n    return data;\n  }, [sortDescriptor, data]);\n  return {data: sortedData, sortDescriptor, onSortChange};\n}\n","import {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {useMutation} from '@tanstack/react-query';\nimport {toast} from '@ui/toast/toast';\nimport {message} from '@ui/i18n/message';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {showHttpErrorToast} from '@common/http/show-http-error-toast';\nimport {useLocation} from 'react-router';\nimport {useNavigate} from '@common/ui/navigation/use-navigate';\nimport {useAuth} from '@common/auth/use-auth';\n\ninterface Response extends BackendResponse {}\n\ninterface Payload {\n  albumId: number;\n}\n\nexport function useDeleteAlbum() {\n  const {pathname} = useLocation();\n  const navigate = useNavigate();\n  const {getRedirectUri} = useAuth();\n\n  return useMutation({\n    mutationFn: (payload: Payload) => deleteAlbum(payload),\n    onSuccess: (response, {albumId}) => {\n      toast(message('Album deleted'));\n      // navigate to homepage if we are on this album page currently\n      if (pathname.startsWith(`/album/${albumId}`)) {\n        navigate(getRedirectUri());\n      }\n      queryClient.invalidateQueries({queryKey: ['tracks']});\n      queryClient.invalidateQueries({queryKey: ['albums']});\n      queryClient.invalidateQueries({queryKey: ['artists']});\n    },\n    onError: r => showHttpErrorToast(r),\n  });\n}\n\nfunction deleteAlbum({albumId}: Payload): Promise<Response> {\n  return apiClient.delete(`albums/${albumId}`).then(r => r.data);\n}\n","import React, {RefObject} from 'react';\n\nexport interface TabsContext {\n  selectedTab: number;\n  setSelectedTab: (newTab: number) => void;\n  tabsRef: RefObject<HTMLElement[]>;\n  size: 'sm' | 'md';\n  isLazy?: boolean;\n  id: string;\n}\n\nexport const TabContext = React.createContext<TabsContext>(null!);\n","import React, {useContext, useState} from 'react';\nimport {useLayoutEffect} from '@react-aria/utils';\nimport clsx from 'clsx';\nimport {TabContext} from '@ui/tabs/tabs-context';\n\ninterface TabLineStyle {\n  width?: string;\n  transform?: string;\n  className?: string;\n}\n\nexport function TabLine() {\n  const {tabsRef, selectedTab} = useContext(TabContext);\n  const [style, setStyle] = useState<TabLineStyle>({\n    width: undefined,\n    transform: undefined,\n    className: undefined,\n  });\n\n  useLayoutEffect(() => {\n    if (selectedTab != null && tabsRef.current) {\n      const el = tabsRef.current[selectedTab];\n      if (!el) return;\n\n      setStyle(prevState => {\n        return {\n          width: `${el.offsetWidth}px`,\n          transform: `translateX(${el.offsetLeft}px)`,\n          // disable initial transition for tabline\n          className: prevState.width === undefined ? '' : 'transition-all',\n        };\n      });\n    }\n  }, [setStyle, selectedTab, tabsRef]);\n\n  return (\n    <div\n      className={clsx(\n        'absolute bottom-0 left-0 h-2 bg-primary',\n        style.className\n      )}\n      role=\"presentation\"\n      style={{width: style.width, transform: style.transform}}\n    />\n  );\n}\n","import React, {Children, cloneElement, isValidElement, ReactNode} from 'react';\nimport clsx from 'clsx';\nimport {FocusScope} from '@react-aria/focus';\nimport {TabProps} from '@ui/tabs/tab';\nimport {TabLine} from '@ui/tabs/tab-line';\n\nexport interface TabListProps {\n  children: ReactNode;\n  // center tabs within tablist\n  center?: boolean;\n  // expand tabs to fill in tablist space fully. By default, tabs are only as wide as their content.\n  expand?: boolean;\n  className?: string;\n  border?: string;\n}\nexport function TabList({\n  children,\n  center,\n  expand,\n  className,\n  border = 'border-b',\n}: TabListProps) {\n  const childrenArray = Children.toArray(children);\n\n  return (\n    <FocusScope>\n      <div\n        className={clsx(\n          // hide scrollbar completely on mobile, show compact one on desktop\n          'max-sm:hidden-scrollbar md:compact-scrollbar relative flex max-w-full overflow-auto',\n          border,\n          className,\n        )}\n        role=\"tablist\"\n        aria-orientation=\"horizontal\"\n      >\n        {childrenArray.map((child, index) => {\n          if (isValidElement<TabProps>(child)) {\n            return cloneElement<TabProps>(child, {\n              index,\n              className: clsx(\n                child.props.className,\n                expand && 'flex-auto',\n                center && index === 0 && 'ml-auto',\n                center && index === childrenArray.length - 1 && 'mr-auto',\n              ),\n            });\n          }\n          return null;\n        })}\n        <TabLine />\n      </div>\n    </FocusScope>\n  );\n}\n","import React, {JSXElementConstructor, ReactNode, useContext} from 'react';\nimport clsx from 'clsx';\nimport {useFocusManager} from '@react-aria/focus';\nimport {LinkProps} from 'react-router';\nimport {TabContext} from '@ui/tabs/tabs-context';\n\nexport interface TabProps {\n  className?: string;\n  index?: number;\n  children: ReactNode;\n  isDisabled?: boolean;\n  padding?: string;\n  elementType?: 'button' | 'a' | JSXElementConstructor<any>;\n  to?: LinkProps['to'];\n  relative?: LinkProps['relative'];\n  replace?: LinkProps['replace'];\n  width?: string;\n  height?: string;\n}\nexport function Tab({\n  index,\n  className,\n  isDisabled,\n  children,\n  padding: paddingProp,\n  elementType = 'button',\n  to,\n  relative,\n  width = 'min-w-min',\n  height,\n}: TabProps) {\n  const {\n    selectedTab,\n    setSelectedTab,\n    tabsRef,\n    size = 'md',\n    id,\n  } = useContext(TabContext);\n  const isSelected = index === selectedTab;\n  const focusManager = useFocusManager();\n  const padding = paddingProp || (size === 'sm' ? 'px-12' : 'px-18');\n\n  const mergedClassname = clsx(\n    'tracking-wide overflow-hidden capitalize text-sm flex items-center justify-center outline-none transition-colors',\n    'focus-visible:ring focus-visible:ring-2 ring-inset rounded whitespace-nowrap cursor-pointer',\n    width,\n    textColor({isDisabled, isSelected}),\n    className,\n    size === 'md' && `${padding} ${height || 'h-48'}`,\n    size === 'sm' && `${padding} ${height || 'h-32'}`,\n    isDisabled && 'pointer-events-none',\n  );\n\n  const onKeyDown = (e: React.KeyboardEvent<HTMLButtonElement>) => {\n    switch (e.key) {\n      case 'ArrowLeft':\n        focusManager?.focusPrevious();\n        break;\n      case 'ArrowRight':\n        focusManager?.focusNext();\n        break;\n      case 'Home':\n        focusManager?.focusFirst();\n        break;\n      case 'End':\n        focusManager?.focusLast();\n        break;\n    }\n  };\n\n  const tabIndex = isSelected ? 0 : -1;\n  const Element = elementType;\n\n  return (\n    <Element\n      disabled={isDisabled}\n      id={`${id}-${index}-tab`}\n      aria-controls={`${id}-${index}-tabpanel`}\n      type=\"button\"\n      role=\"tab\"\n      aria-selected={isSelected}\n      tabIndex={isDisabled ? undefined : tabIndex}\n      onKeyDown={onKeyDown}\n      onClick={() => {\n        setSelectedTab(index!);\n      }}\n      to={to}\n      relative={relative}\n      className={mergedClassname}\n      ref={(el: HTMLElement) => {\n        if (tabsRef.current && el) {\n          tabsRef.current[index!] = el;\n        }\n      }}\n    >\n      {children}\n    </Element>\n  );\n}\n\ninterface TextColorProps {\n  isDisabled?: boolean;\n  isSelected: boolean;\n}\nfunction textColor({isDisabled, isSelected}: TextColorProps): string {\n  if (isDisabled) {\n    return 'text-disabled cursor-default';\n  }\n  if (isSelected) {\n    return 'text-primary';\n  }\n  return 'text-muted hover:text-main';\n}\n","import React, {\n  Children,\n  cloneElement,\n  ComponentPropsWithoutRef,\n  isValidElement,\n  ReactElement,\n  ReactNode,\n  useContext,\n  useRef,\n  useState,\n} from 'react';\nimport clsx from 'clsx';\nimport {useLayoutEffect} from '@react-aria/utils';\nimport {getFocusableTreeWalker} from '@react-aria/focus';\nimport {TabContext} from '@ui/tabs/tabs-context';\n\nexport interface TabPanelsProps {\n  children: ReactNode;\n  className?: string;\n}\nexport function TabPanels({children, className}: TabPanelsProps) {\n  const {selectedTab, isLazy} = useContext(TabContext);\n\n  // filter out falsy values, in case of conditional rendering\n  const panelArray = Children.toArray(children).filter(p => !!p);\n\n  let rendered: ReactNode;\n  if (isLazy) {\n    const el = panelArray[selectedTab] as ReactElement;\n    rendered = isValidElement(el)\n      ? cloneElement<TabPanelProps>(panelArray[selectedTab] as ReactElement, {\n          index: selectedTab,\n        })\n      : null;\n  } else {\n    rendered = panelArray.map((panel, index) => {\n      if (isValidElement<TabPanelsProps>(panel)) {\n        const isSelected = index === selectedTab;\n        return cloneElement<TabPanelProps>(panel, {\n          index,\n          'aria-hidden': !isSelected,\n          className: !isSelected\n            ? clsx(panel.props.className, 'hidden')\n            : panel.props.className,\n        });\n      }\n      return null;\n    });\n  }\n\n  return <div className={className}>{rendered}</div>;\n}\n\ninterface TabPanelProps extends ComponentPropsWithoutRef<'div'> {\n  className?: string;\n  children: ReactNode;\n  index?: number;\n}\nexport function TabPanel({\n  className,\n  children,\n  index,\n  ...domProps\n}: TabPanelProps) {\n  const {id} = useContext(TabContext);\n\n  const [tabIndex, setTabIndex] = useState<number | undefined>(0);\n  const ref = useRef<HTMLDivElement>(null);\n\n  // The tabpanel should have tabIndex=0 when there are no tabbable elements within it.\n  // Otherwise, tabbing from the focused tab should go directly to the first tabbable element\n  // within the tabpanel.\n  useLayoutEffect(() => {\n    if (ref?.current) {\n      const update = () => {\n        // Detect if there are any tabbable elements and update the tabIndex accordingly.\n        const walker = getFocusableTreeWalker(ref.current!, {tabbable: true});\n        setTabIndex(walker.nextNode() ? undefined : 0);\n      };\n\n      update();\n\n      // Update when new elements are inserted, or the tabIndex/disabled attribute updates.\n      const observer = new MutationObserver(update);\n      observer.observe(ref.current, {\n        subtree: true,\n        childList: true,\n        attributes: true,\n        attributeFilter: ['tabIndex', 'disabled'],\n      });\n\n      return () => {\n        observer.disconnect();\n      };\n    }\n  }, [ref]);\n\n  return (\n    <div\n      tabIndex={tabIndex}\n      ref={ref}\n      id={`${id}-${index}-tabpanel`}\n      aria-labelledby={`${id}-${index}-tab`}\n      className={clsx(className, 'focus-visible:outline-primary-light')}\n      role=\"tabpanel\"\n      {...domProps}\n    >\n      {children}\n    </div>\n  );\n}\n","import React, {ReactElement, useId, useMemo, useRef} from 'react';\nimport clsx from 'clsx';\nimport {useControlledState} from '@react-stately/utils';\nimport {TabListProps} from '@ui/tabs/tab-list';\nimport {TabPanelsProps} from '@ui/tabs/tab-panels';\nimport {TabContext, TabsContext} from '@ui/tabs/tabs-context';\n\nexport interface TabsProps {\n  children:\n    | [ReactElement<TabListProps>, ReactElement<TabPanelsProps>]\n    | ReactElement<TabListProps>;\n  size?: 'sm' | 'md';\n  className?: string;\n  selectedTab?: number;\n  defaultSelectedTab?: number;\n  onTabChange?: (newTab: number) => void;\n  isLazy?: boolean;\n  overflow?: string;\n}\n\nexport function Tabs(props: TabsProps) {\n  const {\n    size = 'md',\n    children,\n    className,\n    isLazy,\n    overflow = 'overflow-hidden',\n  } = props;\n\n  const tabsRef = useRef<HTMLButtonElement[]>([]);\n  const id = useId();\n\n  const [selectedTab, setSelectedTab] = useControlledState(\n    props.selectedTab,\n    props.defaultSelectedTab || 0,\n    props.onTabChange,\n  );\n\n  const ContextValue: TabsContext = useMemo(() => {\n    return {\n      selectedTab,\n      setSelectedTab,\n      tabsRef,\n      size,\n      isLazy,\n      id,\n    };\n  }, [selectedTab, id, isLazy, setSelectedTab, size]);\n\n  return (\n    <TabContext.Provider value={ContextValue}>\n      <div className={clsx(className, overflow, 'max-w-full')}>{children}</div>\n    </TabContext.Provider>\n  );\n}\n","import {useFieldArray} from 'react-hook-form';\nimport {FormTextField} from '@ui/forms/input-field/text-field/text-field';\nimport {Trans} from '@ui/i18n/trans';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {CloseIcon} from '@ui/icons/material/Close';\nimport {Button} from '@ui/buttons/button';\nimport {AddIcon} from '@ui/icons/material/Add';\nimport React from 'react';\nimport {UserLink} from '@app/web-player/user-profile/user-link';\n\nexport function ProfileLinksForm() {\n  const {fields, append, remove} = useFieldArray<{links: UserLink[]}>({\n    name: 'links',\n  });\n  return (\n    <div>\n      {fields.map((field, index) => {\n        return (\n          <div key={field.id} className=\"mb-10 flex items-end gap-10\">\n            <FormTextField\n              required\n              type=\"url\"\n              label={<Trans message=\"URL\" />}\n              name={`links.${index}.url`}\n              size=\"sm\"\n              className=\"flex-auto\"\n            />\n            <FormTextField\n              required\n              label={<Trans message=\"Short title\" />}\n              name={`links.${index}.title`}\n              size=\"sm\"\n              className=\"flex-auto\"\n            />\n            <IconButton\n              size=\"sm\"\n              color=\"primary\"\n              className=\"flex-shrink-0\"\n              onClick={() => {\n                remove(index);\n              }}\n            >\n              <CloseIcon />\n            </IconButton>\n          </div>\n        );\n      })}\n      <Button\n        variant=\"text\"\n        color=\"primary\"\n        startIcon={<AddIcon />}\n        size=\"xs\"\n        onClick={() => {\n          append({url: '', title: ''});\n        }}\n      >\n        <Trans message=\"Add another link\" />\n      </Button>\n    </div>\n  );\n}\n","import {useMemo} from 'react';\nimport {useAuth} from '@common/auth/use-auth';\nimport {Artist} from '@app/web-player/artists/artist';\n\nexport function useArtistPermissions(artist: Artist) {\n  const {user, hasPermission} = useAuth();\n  return useMemo(() => {\n    const permissions = {\n      canEdit: false,\n      canDelete: false,\n    };\n    if (user?.id) {\n      const managesArtist = !!user.artists?.find(a => a.id === artist.id);\n\n      permissions.canEdit =\n        hasPermission('artists.update') ||\n        hasPermission('music.update') ||\n        managesArtist;\n\n      permissions.canDelete =\n        hasPermission('artists.delete') ||\n        hasPermission('music.delete') ||\n        managesArtist;\n    }\n    return permissions;\n  }, [user, artist, hasPermission]);\n}\n"],"names":["usePrimaryArtistForCurrentUser","user","useAuth","_a","a","WAVE_WIDTH","WAVE_HEIGHT","BAR_WIDTH","BAR_GAP","generateWaveformData","file","audioContext","resolve","abort","canvas","context","reader","e","buffer","waveData","extractBuffer","channelData","sections","len","maxHeight","vals","i","bufferMeasure","j","scale","val","getBarData","position","length","data","sum","h","w","x","y","ChipList","className","children","size","color","radius","selectable","wrap","startButton","jsxs","clsx","Children","chip","isValidElement","cloneElement","GENRE_MODEL","AddIcon","createSvgIcon","jsx","DragPreview","React","props","ref","render","setChildren","useState","domRef","useRef","useImperativeHandle","draggable","callback","flushSync","createPortal","rootEl","draggables","droppables","dragMonitors","dragSession","interactableEvent","rect","deltaX","deltaY","activeInteraction","setActiveInteraction","name","domRectToObj","updateRects","targets","observer","entries","entry","width","height","left","top","id","target","useDraggable","disabled","preview","hidePreview","options","dragHandleRef","addGlobalListener","removeAllGlobalListeners","useGlobalListeners","state","optionsRef","useLayoutEffect","notifyMonitors","monitor","onDragStart","el","clickedOnHandle","hideNativeGhostImage","ie","node","_b","m","onDragOver","newRect","emptyImage","readFilesFromDataTransfer","dataTransfer","item","getEntryFile","UploadedFile","getEntriesFromDirectory","reject","asyncIterableToArray","iterator","items","DROP_ACTIVATE_TIMEOUT","useDroppable","canDrop","allowEventsOnSelf","fireDragLeave","getDraggable","element","dropResult","_d","_c","sortableLineStrategy","sortSession","onDropPositionChange","previousPosition","newPosition","midY","overIndex","clearLinePreview","addLinePreview","droppableId","droppable","itemIndex","side","moveItemInArray","array","fromIndex","toIndex","from","clamp","to","delta","moveItemInNewArray","newArray","transition","sortableTransformStrategy","sortable","index","currentIndex","rects","newRects","oldRect","sortableTarget","sortableMoveNodeStrategy","moveNode","newIndex","parentEl","strategies","useSortable","type","onSortEnd","onSortStart","onDragEnd","strategy","useEffect","draggableProps","getScrollParent","droppableProps","oldIndex","mergeProps","ALBUM_MODEL","MusicNoteIcon","TrackImage","track","background","trans","useTrans","src","getTrackImageSrc","imgClassName","message","AlbumIcon","AlbumImage","album","ArtistLink","artist","linkProps","finalUri","useMemo","getArtistLink","Link","absolute","link","slugifyString","getBootstrapData","ArtistLinks","artists","linkClassName","onLinkClick","Fragment","Trans","TrackLink","getTrackLink","AlbumLink","uri","getAlbumLink","artistName","albumName","TumblrIcon","ShareIcon","shareLinkSocially","network","image","url","generateShareUrl","openNewWindow","opts","ShareMediaButtons","share","IconButton","FacebookIcon","TwitterIcon","toast","PlayArrowFilledIcon","MicIcon","SmallArtistImage","wrapperClassName","showVerifiedBadge","getSmallArtistImage","CheckIcon","assignAlbumToTracks","albumLayoutKey","useArtist","params","artistId","useParams","useQuery","fetchArtist","apiClient","response","useAlbum","albumId","fetchAlbum","useTrack","trackId","fetchTrack","useTrackPermissions","tracks","hasPermission","permissions","trackArtistIds","managesTrack","useAlbumPermissions","albumArtistIds","managesAlbum","isCtrlKeyPressed","isMac","useGridNavigation","cellCount","rowCount","focusSiblingCell","focusFirstElementAfterGrid","operations","grid","currentCell","row","rowIndex","cellIndex","rowOpCount","cellOpCount","_e","_f","_g","nextCell","nextFocusableElement","getFocusableTreeWalker","walker","next","last","focusWithoutScrolling","TableContext","createContext","useTableCellStyle","isHeader","columns","cellHeight","headerCellHeight","useContext","column","userPadding","justify","TableCell","rowIsHovered","rowContext","style","isCtrlOrShiftPressed","useTableRowStyle","isSelected","isDarkMode","useIsDarkMode","isMobile","useIsMobileMediaQuery","hideBorder","enableSelection","collapseOnMobile","onAction","usePointerEvents","onMoveStart","onMove","onMoveEnd","minimumMovement","preventDefault","stopPropagation","onPress","onLongPress","removeGlobalListener","start","onPointerDown","onPointerMove","onPointerUp","longPressTriggered","createEventHandler","interactableElements","TableRow","renderAs","selectedRows","toggleRow","selectRow","selectRowOnContextMenu","selectionStyle","hideHeaderRow","isTouchDevice","isHovered","setIsHovered","clickedOnInteractable","doubleClickHandler","anyRowsSelected","handleRowTap","domProps","keyboardHandler","contextMenuHandler","styleClassName","RowElement","CheckboxColumnConfig","SelectAllCheckbox","Skeleton","SelectRowCheckbox","Checkbox","onSelectionChange","allRowsSelected","someRowsSelected","d","ArrowDownwardIcon","HeaderCell","sortDescriptor","onSortChange","enableSorting","sortingKey","allowSorting","orderBy","orderDir","sortActive","ariaSort","toggleSorting","newSort","sortVisible","sortVariants","AnimatePresence","TableHeaderRow","columnIndex","Table","userColumns","propsSelectedRows","propsDefaultSelectedRows","propsOnSelectionChange","propsSortDescriptor","propsOnSortChange","onDelete","ariaLabelledBy","renderRowAs","tableBody","meta","propsTableRef","closeOnInteractOutside","isCollapsedMode","useControlledState","useCallback","newValues","merge","filteredColumns","c","visibleInMode","contextValue","navProps","tableBodyProps","BasicTableBody","tableRef","useObjectRef","useInteractOutside","MAX_SAFE_INTEGER","sortArrayOfObjects","b","valueA","sortingDataAccessor","valueB","valueAType","valueBType","comparatorResult","key","value","dot","isNumberValue","numberValue","useSortableTableData","useDeleteAlbum","pathname","useLocation","navigate","useNavigate","getRedirectUri","useMutation","payload","deleteAlbum","queryClient","showHttpErrorToast","r","TabContext","TabLine","tabsRef","selectedTab","setStyle","prevState","TabList","center","expand","border","childrenArray","FocusScope","child","Tab","isDisabled","paddingProp","elementType","relative","setSelectedTab","focusManager","useFocusManager","padding","mergedClassname","textColor","onKeyDown","tabIndex","Element","TabPanels","isLazy","panelArray","p","rendered","panel","TabPanel","setTabIndex","update","Tabs","overflow","useId","ContextValue","ProfileLinksForm","fields","append","remove","useFieldArray","field","FormTextField","CloseIcon","Button","useArtistPermissions","managesArtist"],"mappings":"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"}